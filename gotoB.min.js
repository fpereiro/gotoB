!function(){if("object"==typeof exports)var d=exports;else d=window.dale={};var p=function(){return Object.prototype.toString.call(arguments).match("arguments")}(),g=function(e,t){var n=typeof e;return"function"===n?Object.prototype.toString.call(e).match(/regexp/i)?"regex":"function":"object"!==n&&"number"!==n?n:e instanceof Array?"array":"number"===n?isNaN(e)?"nan":isFinite(e)?e%1==0?"integer":"float":"infinity":null===e?"null":"array"===(n=Object.prototype.toString.call(e).replace("[object ","").replace("]","").toLowerCase())||"date"===n?n:"regexp"===n?"regex":t?!p&&"function"===n(e.callee)?"arguments":n:"object"};try{d.clog=console.log.bind(console)}catch(t){d.clog=function(){var e=d.go(arguments,function(e){return e===undefined?"undefined":e}).join(" ");window.console?window.console.log(e):alert(e)}}var e=function(l){return function(e,t,n,r){if("go"===l)var i=t,o=!0===n,a=[],s=0;else if("fil"===l)i=n,o=!0===r,a=[],s=0;else if("obj"!==l)i=n,o=!0===r;else if("object"===g(t))i=n,o=!0===r,a=t;else i=t,o=!0===n,a={};if("function"!==g(i))return d.clog(("go"===l||"obj"===l&&"object"!==g(t)?"Second":"Third")+" argument passed to dale."+l+" must be a function but instead is",i,"with type",g(i)),!1;if(e===undefined)return a;var u=function(e){if("go"===l)a[s++]=e;else if("fil"===l)e!==t&&(a[s++]=e);else{if("obj"!==l)return a=e,"stop"===l?e===t:e!==t;if(e===undefined)return;if("array"!==g(e)||2!==e.length)return d.clog("array"===g(e)?"fun passed to dale.obj must return undefined or an array of length 2 but instead returned an array of length "+e.length:"fun passed to dale.obj must return undefined or an array of length 2 but instead returned a value of type "+g(e)),!(a=!1);a[e[0]]=e[1]}},c=g(e);if("object"===c&&("[object Arguments]"!==Object.prototype.toString.call(e)&&(p||"function"!==g(e.callee))||(c="array",e=[].slice.call(e))),"array"===c)for(var f=0;f<e.length&&!u(i(e[f],parseInt(f)));f++);else if("object"===c){for(var f in e)if((o||!e.hasOwnProperty||e.hasOwnProperty(f))&&u(i(e[f],f)))break}else u(i(e,0));return a}};d.go=e("go"),d.fil=e("fil"),d.obj=e("obj"),d.stop=e("stop"),d.stopNot=e("stopNot"),d.keys=function(e,t){return d.go(e,function(e,t){return t},t)},d.times=function(e,t,n){if(0===e)return[];if("integer"!==g(e)||e<0)return d.clog("steps must be a positive integer or zero."),!1;if(t===undefined)t=1;else if("integer"!==g(t)&&"float"!==g(t))return d.clog("start must be an integer or float."),!1;if(n===undefined)n=1;else if("integer"!==g(n)&&"float"!==g(n))return d.clog("step must be an integer or float."),!1;for(var r=[t];r.length<e;)t+=n,r.push(t);return r},d.acc=function(e,t,n,r){var i=arguments.length===("boolean"===g(arguments[arguments.length-1])?4:3),o=i?t:undefined,a=i?n:t,s=i?r:n;if("function"!==g(a))return d.clog("fun must be a function but instead is of type",g(a)),!1;var u=!0;return d.go(e,function(e,t){if(!i&&u)return u=!1,o=e;o=a(o,e)},s),o}}(),function(){var n="object"==typeof exports,m=n?require("dale"):window.dale;if(n)var b=exports;else b=window.teishi={};Array.prototype.indexOf||(Array.prototype.indexOf=function(n,r){var e=m.stopNot(this,undefined,function(e,t){if(!(r&&t<r))return n===e?t:void 0});return e===undefined?-1:e});var r=function(){return Object.prototype.toString.call(arguments).match("arguments")}();b.type=function(e,t){var n=typeof e;return"function"===n?Object.prototype.toString.call(e).match(/regexp/i)?"regex":"function":"object"!==n&&"number"!==n?n:e instanceof Array?"array":"number"===n?isNaN(e)?"nan":isFinite(e)?e%1==0?"integer":"float":"infinity":null===e?"null":"array"===(n=Object.prototype.toString.call(e).replace("[object ","").replace("]","").toLowerCase())||"date"===n?n:"regexp"===n?"regex":t?!r&&"function"===b.type(e.callee)?"arguments":n:"object"},b.str=function(){try{return JSON.stringify.apply(JSON.stringify,arguments)}catch(e){return!1}},b.parse=function(){try{return JSON.parse.apply(JSON.parse,arguments)}catch(e){return!1}},b.simple=function(e){var t=b.type(e);return"array"!==t&&"object"!==t},b.complex=function(e){return!b.simple(e)},b.copy=function(r,i){if(b.simple(r))return r;var e=b.type(r,!0),o="array"===e||"arguments"===e?[]:{};return m.go(r,function(e,t){if(b.simple(e))return o[t]=e;var n=i?i.concat():[r];return-1<n.indexOf(e)?o[t]="[Circular]":(n.push(e),o[t]=b.copy(e,n))}),o},b.eq=function(e,n){return b.simple(e)&&b.simple(n)?e===n:b.type(e,!0)===b.type(n,!0)&&(b.str(m.keys(e).sort())===b.str(m.keys(n).sort())&&!1!==m.stop(e,!1,function(e,t){return b.eq(e,n[t])}))},b.last=function(e,t){return-1===["array","arguments"].indexOf(b.type(e,!0))?b.clog("First argument passed to teishi.last must be array or arguments but instead has type "+b.type(e,!0)):t!==undefined&&("integer"!==b.type(t)||t<1)?b.clog("Second argument passed to teishi.last must be either undefined or an integer larger than 0."):e[e.length-(t||1)]},b.time=function(e){return arguments.length?new Date(e).getTime():(new Date).getTime()};var i,f=function(){return n?"[0m":""},l=function(){return n?"[1m":""},d=function(){return n?"[37m":""},p=function(e){if(!n)return"";for(var t=i;i===t;)t=Math.round(5*Math.random()+1);return"["+(e?"4":"3")+(i=t)+"m"};b.clog=function(){var u=l();!function c(e,i){var o=b.type(e),a=(i=i||0,!0);"object"===o&&"[object Arguments]"===Object.prototype.toString.call(e)&&(o="array");var s=i<2?"":"\n"+m.go(m.times(i-1),function(e){return"   "}).join("");0<i&&(u+="array"===o?d()+"[":d()+"{"),m.go(e,function(e,t){var n=b.type(e);if(0===i&&0===t&&("string"===n||"integer"===n))return u+=p(!(a=!1))+e+":"+f()+l();if(a||(u+=d()+(0===i?" ":", ")),a=!1,"string"===n&&0<i&&(e="'"+e+"'"),"function"===n){var r=(e+="").match(/\s+(?=}$)/);null!==r&&(e=e.replace(new RegExp(r[0],"g"),"\n")),150<e.length&&(e=e.slice(0,150)+"...\n"),1<i&&(e=e.replace(/\n/g,"array"===o?s:"\n"+(t+": ").replace(/./g," ")+s.slice(1)))}u+=p(),"object"===o&&(u+=s+(t.match(/^[0-9a-zA-Z_]+$/)?t:"'"+t+"'")+": "),"array"===n||"object"===n?c(e,i+1):u+="object"===o?e:s+e}),0<i&&("array"===o&&(u+=(1<i?"\n":"")+s.slice(4)+d()+"]"),"object"===o&&(u+=(1<i?"\n":"")+s.slice(4)+d()+"}"))}(b.copy(arguments));var e=new Date;return m.clog("("+e[e.toISOString?"toISOString":"toString"]()+")",u+f()),!1},b.lno=function(){n=!1},b.makeTest=function(c,f){if("function"!==b.type(c))return b.clog("teishi.makeTest","fun passed to teishi.makeTest should be a function but instead is",c,"with type",b.type(c));if("string"===b.type(f)&&(f=[f]),"array"!==b.type(f))return b.clog("teishi.makeTest","clauses argument passed to teishi.makeTest should be an array but instead is",f,"with type",b.type(f));if("string"!==b.type(f[0]))return b.clog("teishi.makeTest","shouldClause passed to teishi.makeTest should be a string but instead is",f[0],"with type",b.type(f[0]));if(f[1]!==undefined&&("array"!==b.type(f[1])&&(f[1]=[f[1]]),!0!==m.stopNot(f[1],!0,function(e){var t=b.type(e);return"string"===t||"function"===t||b.clog("teishi.makeTest","Each finalClause passed to teishi.makeTest should be a string or a function but instead is",e,"with type",t)})))return;return function(e,t,n,r,i,o){var a=c(n,r);if(!0===a)return!0;if("array"===b.type(a))return a;var s=[],u=0;return i!==undefined&&(s[u++]="each of the"),t[0]&&(s[u++]=t[0]),e&&(s[u++]="passed to",s[u++]=e),s[u++]=f[0],o!==undefined&&(s[u++]="one of"),s[u++]=o!==undefined?o:r,t[1]&&(s[u++]="("+t[1]+")"),s[u++]=i!==undefined?"but one of":"but instead",i!==undefined&&(s[u++]=i),s[u++]="is",s[u++]=n,m.go(f[1],function(e){s[u++]="function"!=typeof e?e:e(n,r)}),s}},b.test={type:b.makeTest(function(e,t){return b.type(e)===t},["should have as type",["with type",b.type]]),equal:b.makeTest(b.eq,"should be equal to"),notEqual:b.makeTest(function(e,t){return!b.eq(e,t)},"should not be equal to"),range:b.makeTest(function(n,e){return"object"!==b.type(e,!0)?["Range options object must be an object but instead is",e,"with type",b.type(e,!0)]:"{}"===b.str(e)||m.stopNot(e,!0,function(e,t){return"min"!==t&&"max"!==t&&"less"!==t&&"more"!==t?['Range options must be one of "min", "max", "less" and "more", but instead is',t]:"min"===t?e<=n:"max"===t?n<=e:"less"===t?n<e:e<n})},"should be in range"),match:b.makeTest(function(e,t){return"string"!==b.type(e)?["Invalid comparison string passed to teishi.test.match. Comparison string must be of type string but instead is",e,"with type",b.type(e)]:"regex"!==b.type(t)?["Invalid regex passed to teishi.test.match. Regex must be of type regex but instead is",t,"with type",b.type(t)]:null!==e.match(t)},"should match")},b.validateRule=function(r){var e=b.type(r);if("function"===e||"boolean"===e)return!0;if("array"!==e)return["each teishi rule must be an array or boolean or function but instead is",r,"with type",e];var i,o,t=b.type(r[0]);return"string"!==t&&("array"!==t||2!==r[0].length||"string"!==b.type(r[0][0])||"string"!==b.type(r[0][1]))||(3===r.length||(r.length<3||5<r.length?["Each teishi simple rule must be an array of length between 3 and 5, but instead is",r,"and has length",r.length]:m.stopNot(r,!0,function(e,t){if(t<3)return!0;var n=b.type(e);if("string"===n){if("oneOf"!==e&&"each"!==e&&"eachOf"!==e)return["Invalid multi parameter",e,". Valid multi parameters are",["oneOf","each","eachOf"]];if(o)return["You can pass only one multi parameter to a teishi simple rule but instead you passed two:",r[3],"and",r[4]];o=e}else{if("function"!==n)return["Elements #4 and #5 of a teishi simple rule must be either a string or a function, but element","#"+(t+1),"is",e,"and has type",n];if(i)return["You can pass only one test function to a teishi simple rule but instead you passed two:",r[3],"and",r[4]];i=e}return!0})))};var v=function(e,t){return t===undefined?b.clog.apply(b.clog,["teishi.v"].concat(e)):(e=m.go(e,function(e){return b.complex(e)?b.str(e):e+""}).join(" "),!0===t?e:(t(e),!1))};b.v=function(e,t,n){if("string"===b.type(e))var r=e,i=t,o=n;else r="",i=e,o=t;if(o!==undefined&&!0!==o&&"function"!==b.type(o))return b.clog("teishi.v","Invalid apres argument. Must be either undefined, true, or a function.");var a=b.validateRule(i);if(!0!==a)return v(a,o);var s=b.type(i);if("boolean"===s)return i;if("function"===s)return b.v(r,i(),o);if(0===i.length)return!0;var u=b.type(i[0]);if("boolean"===u&&2===i.length&&"array"===b.type(i[1]))return!1===i[0]||b.v(r,i[1],o);if("string"!==u&&("array"!==u||2!==i[0].length||"string"!==b.type(i[0][0])||"string"!==b.type(i[0][1])))return m.stopNot(i,!0,function(e){return b.v(r,e,o)});var c,f=b.type(i[3]),l=b.type(i[4]),d="function"===f?i[3]:"function"===l?i[4]:b.test.type,p="string"===f?i[3]:"string"===l?i[4]:undefined,g="array"===u?i[0]:[i[0]],h=b.type(i[1],!0),y=b.type(i[2],!0);return("each"===p||"eachOf"===p)&&("array"===h&&0===i[1].length||"object"===h&&0===m.keys(i[1]).length||i[1]===undefined)||(!0===(c="oneOf"!==p&&"eachOf"!==p||!("array"===y&&0===i[2].length||"object"===y&&0===m.keys(i[2]).length||i[2]===undefined)?p===undefined?d(r,g,i[1],i[2]):"each"===p?m.stopNot(i[1],!0,function(e){return d(r,g,e,i[2],i[1])}):"oneOf"===p?m.stop(i[2],!0,function(e){return d(r,g,i[1],e,undefined,i[2])}):m.stopNot(i[1],!0,function(t){return m.stop(i[2],!0,function(e){return d(r,g,t,e,i[1],i[2])})}):["To field of teishi rule is",i.to,"but multi attribute",p,"requires it to be non-empty, at teishi step",i])||v(c,o))},b.stop=function(){return!0!==b.v.apply(b.v,arguments)}}(),function(){var e="object"==typeof exports,u=e?require("dale"):window.dale,i=e?require("teishi"):window.teishi;if(e)var c=exports;else c=window.lith={};var f=i.type,l=i.clog;c.k={lithbagElements:["string","integer","float","array","undefined"],tags:["!DOCTYPE HTML","LITERAL","a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],voidTags:["!DOCTYPE HTML","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]},c.entityify=function(e,t){return!(!t&&i.stop("lith.entityify",["Entityified string",e,"string"]))&&e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;")},c.v=function(t){var e=f(t);if("array"===e&&"string"===f(t[0])&&-1<c.k.tags.indexOf(t[0])){var n="object"===f(t[1])?t[1]:undefined,r=t[n?2:1];return!!i.v([["lith length",t.length,{min:1,max:3},i.test.range],[n===undefined,["length of lith without attributes",t.length,{max:2},i.test.range]],[["lith attribute keys","start with an ASCII letter, underscore or colon, and be followed by letters, digits, underscores, colons, periods, dashes, extended ASCII characters, or any non-ASCII characters."],u.keys(n),/^[a-zA-Z_:][a-zA-Z_:0-9.\-\u0080-\uffff]*$/,"each",i.test.match],["lith attribute values",n,["string","integer","float","undefined","null","boolean"],"eachOf"],["lith contents",r,c.k.lithbagElements,"oneOf"]],function(e){l("lith.v - Invalid lith",{error:e,"original input":t})})&&"Lith"}return!!i.v([["lithbag",e,c.k.lithbagElements,"oneOf",i.test.equal],["array"===e,["lithbag elements",t,c.k.lithbagElements,"eachOf"]]],function(e){l("lith.v - Invalid lithbag",{error:e,"original input":t})})&&"Lithbag"},c.g=function(e,t){if(t||c.prod)return!0!==(t||c.prod)?l("lith.g","prod or lith.prod must be true or undefined."):"array"===f(e)&&-1<c.k.tags.indexOf(e[0])?c.generateLith(e,!0):c.generateLithbag(e,!1,!0);var n=c.v(e);return!!n&&c["generate"+n](e)},c.generateLithbag=function(e,n,r){var i="";return!1!==u.stop(e,!1,function(e){if(e!==undefined){f(e);if("array"!==f(e))return i+=n?e:c.entityify(e+"",r);var t=c.g(e,r);if(!1===t)return!1;i+=t}})&&i},c.generateLith=function(e,n){var t="object"===f(e[1])?e[1]:undefined,r=e[t?2:1];if("LITERAL"===e[0])return r;var i="<"+e[0];if(u.go(t,function(e,t){!e&&0!==e||(i+=" "+c.entityify(t+"",n)+'="'+c.entityify(e+"",n)+'"')}),i+=">","array"===f(r)){var o="style"===e[0]?c.css.g(r,n):c.g(r,n);if(!1===o)return!1;i+=o}else i+=c.generateLithbag(r,"style"===e[0]||"script"===e[0],n);return-1===c.k.voidTags.indexOf(e[0])&&(i+="</"+e[0]+">"),i},c.css={},c.css.v=function(t){if(i.stop(["litc or litcbag",t,"array"],function(e){l("lith.css.v - Invalid litc or litcbag",{error:e,"original input":t})}))return!1;if(0===t.length||"array"===f(t[0]))return!0;var e="object"===f(t[1])?t[1]:undefined,n=t[e?2:1];return i.v([["litc length",t.length,{min:1,max:3},i.test.range],[e===undefined,["length of litc without attributes",t.length,{max:2},i.test.range]],["litc selector",t[0],"string"],c.css.vAttributes(e),["LITERAL"!==t[0],["litc contents",n,["undefined","array"],"oneOf"]]],function(e){l("lith.css.v - Invalid litc",{error:e,"original input":t})})},c.css.vAttributes=function(e){return i.v([["litc attribute values",e,["string","integer","float","object","undefined","null","boolean"],"eachOf"]])},c.css.g=function(e,r,i){if(r||c.prod){if(!0!==(r||c.prod))return l("lith.css.g","prod or lith.prod must be true or undefined.");r=!0}if(!r&&!1===c.css.v(e))return!1;if(0===e.length)return"";if("LITERAL"===e[0])return e[1];var o="";if("array"===f(e[0]))return!1!==u.stop(e,!1,function(e,t){var n=c.css.g(e,r,i);if(!1===n)return!1;o+=n})&&o;i===undefined&&(i="");var t="object"===f(e[1])?e[1]:undefined,n=e[t?2:1];i=u.go(i.split(/,\s*/),function(t){return u.go(e[0].split(/,\s*/),function(e){return e.match(/&/)?e.replace("&",t):t+(0===t.length?"":" ")+e}).join(", ")}).join(", "),o+=i+"{";var a=function(e){return!1!==c.css.vAttributes(e)&&u.stop(e,!1,function(t,e){if(t||0===t){var n=f(t);if("object"===n)return a(t);"integer"===n&&(t<0||1<t)&&(t+="px"),"float"!==n&&1!==t||(t=100*t+"%"),u.go(e.split(/,\s*/),function(e){o+=e+":"+t+";"})}})};if(!1===a(t))return!1;if(o===i+"{"?o="":o+="}",n){var s=c.css.g(n,r,i);if(!1===s)return!1;o+=s}return o},c.css.media=function(e,t){return!i.stop(["selector",e,"string"])&&[["LITERAL","@media "+e+" {"],t,["LITERAL","}"]]},c.css.style=function(e,t){var n=c.css.g(["",e],t);return!1===n?n:n.slice(1,-1)}}(),function(){var e="object"==typeof exports,s=e?require("dale"):window.dale,u=e?require("teishi"):window.teishi,c=u.type,t=u.clog,n=function(e){if(!u.stop([["store",e,["array","object","undefined"],"oneOf"]])){var a={listeners:{},store:e||{},log:[],error:t,count:0,say:function(){var t="object"===c(arguments[0])?arguments[0]:undefined,e=arguments[t?1:0],n=arguments[t?2:1];if(u.simple(n)&&(n=[n]),!a.prod&&u.stop("r.say",[["context",t,["object","undefined"],"oneOf"],[t!==undefined,[function(){return["x.from",t.from,["string","undefined"],"oneOf"]}]],["verb",e,"string"]],function(e){a.error(t,"r.say",e)}))return!1;if(!a.prod&&!a.isPath(n))return a.error(t,"r.say","Invalid path. Arguments:",{verb:e,path:n});var r=arguments,i=arguments.length===(t?3:2)?undefined:s.go(s.times(arguments.length-(t?3:2),t?3:2),function(e){return r[e]}),o=t?t.from:undefined;return t={from:"E"+a.random(),verb:e,path:n,args:i},a.logpush(o,t.from,e,n,i),a.mill(i===undefined?[t]:[t].concat(i)),t.from},listen:function(){var e,t=arguments[arguments.length-1];if(arguments.length<2)return a.error("r.listen","Too few arguments passed to r.listen");if(2===arguments.length?e=arguments[0]:((e=3===arguments.length?{}:arguments[2]).verb=arguments[0],e.path=arguments[1]),u.simple(e.path)&&(e.path=[e.path]),!a.prod&&u.stop("r.listen",[["options",e,"object"],["keys of options",s.keys(e),["verb","path","id","parent","priority","burn","match"],"eachOf",u.test.equal],function(){return[["options.verb",e.verb,["string","regex"],"oneOf"],["options.id",e.id,["string","integer","undefined"],"oneOf"],["options.parent",e.parent,["string","integer","undefined"],"oneOf"],["options.priority",e.priority,["undefined","integer"],"oneOf"],["options.burn",e.burn,["undefined","boolean"],"oneOf"],["options.match",e.match,["undefined","function"],"oneOf"]]},["listener function",t,"function"]],function(e){a.error("r.listen",e)}))return!1;if(!a.prod&&!a.isPath(e.path,!0))return a.error("r.listen","Invalid path. Options:",e);if(e.id!==undefined){if(e.id+="",!a.prod&&a.listeners[e.id])return a.error("r.listen","A listener with id",e.id,"already exists.")}else e.id=a.random();return e.lfun=t,e.index=a.count++,(a.listeners[e.id]=e).id},forget:function(n,r){if(!a.prod&&r!==undefined&&"function"!==c(r))return a.error("r.forget","Second argument to r.forget must be a function or undefined. Id is:",n);if(!a.prod&&!a.listeners[n])return a.error("r.forget","Listener",n,"does not exist.");var e=a.listeners[n];delete a.listeners[n],r&&r(e),s.go(a.listeners,function(e,t){e.parent===n&&a.forget(t,r)})},isPath:function(e,t){return u.v([["path",e,["array","integer","string"].concat(t?"regex":[]),"oneOf"],["path",e,["integer","string"].concat(t?"regex":[]),"eachOf"]],function(){})},random:function(){return Math.random().toString(16).slice(2)},compare:function(e,t){return"*"===e||"*"===t||("regex"===c(e)?null!==(t+"").match(e):e===t)},logpush:function(e,t,n,r,i){a.log&&a.log.push({t:u.time(),from:e,id:t,verb:n,path:r,args:i})},mill:function(n){var r=function(e){if(0!==e.length){n[0].cb=function(){r(e)};var t=e.shift();if(n[0].listener=t,!a.listeners[t.id])return r(e);t.burn&&a.forget(t.id),"function"!==c(t.lfun.apply(null,n))&&r(e)}};r(a.sort(a.match(n[0].verb,n[0].path,a.listeners)))},match:function(e,n,t){var r=[];return s.go(t,function(t){if(!t.disabled){if(t.match)return!0===t.match(t,{verb:e,path:n})?r.push(t):undefined;if(a.compare(t.verb,e))return 0===t.path.length||0===n.length?r.push(t):void(s.stop(s.times(Math.min(t.path.length,n.length),0),!1,function(e){return a.compare(t.path[e],n[e])})&&r.push(t))}}),r},sort:function(e){return e.sort(function(e,t){var n=(t.priority||0)-(e.priority||0);return 0!=n?n:e.index-t.index})}};return a}};e?module.exports=n:window.R=n}(),function(){if("object"==typeof exports)return console.log("cocholate only works in a browser!");var s=window.dale,u=window.teishi,c=u.type,f=u.clog;document.createElement("_").insertAdjacentHTML||(HTMLElement.prototype.insertAdjacentHTML=function(e,t){var n=document.createElement("div");for(n.innerHTML=t;n.firstChild;)"beforeBegin"===e?this.parentNode.insertBefore(n.firstChild,this):"afterBegin"===e?this.insertBefore(n.firstChild,this.firstChild):"beforeEnd"===e?this.appendChild(n.firstChild):this.parentNode.insertBefore(n.firstChild,this.nextElementSibling)});var l=window.c=function(e,t){if(u.stop("c",["fun",t,["function","undefined"],"oneOf"]))return!1;var n=e&&e.nodeName,r=n?[e]:l.find(e);if(!1===r)return!1;if(t){var i=s.go(arguments,function(e){return e}).slice(2);r=s.go(r,function(e){return t.apply(undefined,[e].concat(i))})}return n||"body"===e||"string"===c(e)&&e.match(/^[a-z0-9]*#[^\s\[>,:]+$/)?r[0]:r};l.nodeListToArray=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},l.setop=function(e,t,n){if("and"===e)return s.fil(t,undefined,function(e){return-1<n.indexOf(e)?e:undefined});var r=t.slice();return"or"===e?s.go(n,function(e){-1===r.indexOf(n)&&r.push(e)}):(0===r.length&&(r=l.nodeListToArray(document.getElementsByTagName("*"))),s.go(n,function(e){var t=r.indexOf(e);-1<t&&r.splice(t,1)})),r},l.find=function(t){var e=c(t);if(u.stop("cocholate",[["selector",t,["array","string","object"],"oneOf"],function(){return[["array"===e,["first element of array selector",t[0],[":and",":or",":not"],"oneOf",u.test.equal]],["object"===e,[["selector keys",s.keys(t),["selector","from"],"eachOf",u.test.equal],["selector.selector",t.selector,["array","string"],"oneOf"],function(){return!("object"!==c(t.from)||document.querySelectorAll&&!t.from.querySelectorAll)||f("teishi.v","selector.from passed to cocholate must be a DOM element.")}]]]}]))return!1;if("array"!==e){if(document.querySelectorAll&&"string"===e)return l.nodeListToArray(document.querySelectorAll(t));if(document.querySelectorAll&&"object"===e)return l.nodeListToArray(t.from.querySelectorAll(t.selector));var n=t.from?t.from:document;if("*"!==(t="string"===e?t:t.selector)&&!t.match(/^[a-z0-9]*(#|\.)?[a-z0-9]+$/i))return f("The selector "+t+" is not supported in IE <= 7 or Firefox <= 3.");var r=t.match("#")?"id":t.match(/\./)?"class":undefined,i=2!==(t=t.split(/#|\./)).length&&r?undefined:t[0].toUpperCase();return s.fil(l.nodeListToArray(n.getElementsByTagName(i||"*")),undefined,function(e){if(!("class"===r&&-1===(e.className||"").split(/\s/).indexOf(u.last(t))||"id"===r&&e.id!==u.last(t)))return e})}var o=t.shift(),a=[];return s.stop(t,!1,function(e,t){var n=l.find(e);if(!1===n)return a=!1;a=0===t&&":not"!==o?n:l.setop(o.replace(":",""),a,n)}),a},l.empty=function(e){l(e,function(e){s.go(l.nodeListToArray(e.getElementsByTagName("*")),function(e){e.parentNode&&e.parentNode.removeChild(e)})})},l.fill=function(e,t){if(u.stop("c.fill",["html",t,"string"]))return!1;l.empty(e),l(e,function(e){e.innerHTML=t})},l.place=function(e,t,n){if(u.stop("c.place",[["where",t,["beforeBegin","afterBegin","beforeEnd","afterEnd"],"oneOf",u.test.equal],["html",n,"string"]]))return!1;l(e,function(e){e.insertAdjacentHTML(t,n)})},l.get=function(e,n,r){if(u.stop("c.get",["attributes",n,["string","array","undefined"],"oneOf"]))return!1;var i=[null,"",!1,0,"false"];return l(e,function(t){return n!==undefined?s.obj(n,function(e){return r?[e,t.style[e]||null]:[e,t.getAttribute(e)]}):r?s.obj(t.style.length?s.times(t.style.length,0):s.keys(t.style),function(e){return t.style.length?[t.style[e],t.style[t.style[e]]]:-1===i.indexOf(t.style[e])?[e,t.style[e]]:void 0}):s.obj(t.attributes,{"class":t["class"]||t.className},function(e,t){if(e&&e.nodeName&&-1===i.indexOf(e.nodeValue))return[e.nodeName,e.nodeValue]})})},l.set=function(e,t,r,i){if(u.stop("c.set",[["attributes",t,"object"],[["attribute keys","start with an ASCII letter, underscore or colon, and be followed by letters, digits, underscores, colons, periods, dashes, extended ASCII characters, or any non-ASCII characters."],s.keys(t),/^[a-zA-Z_:][a-zA-Z_:0-9.\-\u0080-\uffff]*$/,"each",u.test.match],["attribute values",t,["integer","float","string","null"],"eachOf"]]))return!1;l(e,function(n){s.go(t,function(e,t){r?n.style[t]=null===e?"":e:null===e?n.removeAttribute(t):n.setAttribute(t,e)}),n.onchange&&!i&&n.onchange()})},l.fire=function(e,r){if(u.stop("c.fire",["event type",r,"string"]))return!1;l(e,function(e){var t;try{t=new Event(r)}catch(n){t=document.createEvent?document.createEvent("Event"):document.createEventObject(),document.createEvent&&t.initEvent(r,!1,!1)}return e.dispatchEvent?e.dispatchEvent(t):e.fireEvent?e.fireEvent(r,t):f("c.fire error","Unfortunately, this browser supports neither EventTarget.dispatchEvent nor element.fireEvent.")})},l.ready=function(e){if(window.addEventListener)return window.addEventListener("load",e,!1);if(window.attachEvent)return window.attachEvent("onload",e);var t=setInterval(function(){"complete"===document.readyState&&(e()||clearInterval(t))},10)},l.cookie=function(e){return!1===e?s.go(document.cookie.split(/;\s*/),function(e){return document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()),e}):s.obj((e||document.cookie).split(/;\s*/),function(e){if(""!==e)return[(e=e.split("="))[0],e.slice(1).join("=")]})},l.ajax=function(e,t,n,r,i){if(e=e||"GET",n=n||{},r=r||"",i=i||function(){},u.stop("c.ajax",[["method",e,"string"],["path",t,"string"],["headers",n,"object"],["callback",i,"function"]]))return!1;var o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return o.open(e.toUpperCase(),t,!0),u.complex(r)&&"formdata"!==c(r,!0)&&(n["content-type"]=n["content-type"]||"application/json",r=u.str(r)),s.go(n,function(e,t){o.setRequestHeader(t,e)}),o.onreadystatechange=function(){if(4===o.readyState){if(200!==o.status&&304!==o.status)return i(o);var r,e={xhr:o,headers:s.obj(o.getAllResponseHeaders().split(/\r?\n/),function(e){if(""!==e){var t=e.match(/^[^:]+/)[0],n=e.replace(t,"").replace(/:\s+/,"");return t.match(/^content-type/i)&&n.match(/application\/json/i)&&(r=!0),[t,n]}})};e.body=r?u.parse(o.responseText):o.responseText,i(null,e)}},o.send(r),{headers:n,body:r,xhr:o}},l.loadScript=function(e,r){l.ajax("get",e,{},"",function(e,t){if(e)return r(e);var n=document.createElement("script");try{n.appendChild(document.createTextNode(t.body))}catch(e){n.text=t.body}document.body.appendChild(n),r(null,t)})}}(),function(){if("object"==typeof exports)return console.log("gotoв only works in a browser!");var a=window.dale,s=window.teishi,i=window.lith,u=window.R(),t=window.c,c=s.type,f=window.B={v:"2.0.0",B:"в",t:s.time(),r:u,listeners:u.listeners,store:u.store,log:u.log,say:u.say,listen:u.listen,forget:u.forget};u.error=f.error=function(){var e="object"===c(arguments[0])?arguments[0]:undefined,t=a.go(arguments,function(e){return e}).slice(e?1:0);return f.say.apply(null,[e||{},"error"].concat(t)),!1},f.get=function(){var n="array"===c(arguments[0])?arguments[0]:a.go(arguments,function(e){return e});if(!f.prod&&!u.isPath(n))return f.error("B.get","Invalid path:",n)||undefined;var r=f.store;return!1===a.stop(n,!1,function(e,t){if(t<n.length-1&&s.simple(r[e]))return!1;r=r[e]})?undefined:r},f.set=function(){var e="object"===c(arguments[0])?arguments[0]:undefined,r=arguments[e?1:0],i=arguments[e?2:1];if(!f.prod&&!u.isPath(r))return f.error(e||{},"B.set","Invalid path:",r);if("array"!==c(r)&&(r=[r]),0===r.length)return!f.prod&&s.simple(i)?f.error(e||{},"B.set","Cannot set B.store to something that is not an array or object."):(f.store=i,!0);var t="string"===c(r[0])?"object":"array";c(f.store)!==t&&(f.store="object"==t?{}:[]);var o=f.store;return a.go(r,function(e,t){if(t===r.length-1)return o[e]=i;var n="string"===c(r[t+1])?"object":"array";c(o[e])!==n&&(o[e]="object"==n?{}:[]),o=o[e]}),!0},f.add=function(){var n="object"===c(arguments[0])?arguments[0]:undefined,e=arguments[n?1:0];if(!f.prod&&!u.isPath(e))return f.error(n||{},"B.add","Invalid path:",e);f.get(e)===undefined&&f.set(e,[]);var r=f.get(e);return f.prod||"array"===c(r)?(a.go(arguments,function(e,t){(n?1:0)<t&&r.push(e)}),!0):f.error(n||{},"B.add","Cannot add to something that is not an array. Path:",e)},f.rem=function(){var t="object"===c(arguments[0])?arguments[0]:undefined,n=arguments[t?1:0];if(!f.prod&&!u.isPath(n))return f.error(t||{},"B.rem","Invalid path:",n);var r=f.get(n),e=c(r),i="array"===c(arguments[t?2:1])?arguments[t?2:1]:a.go(arguments,function(e){return e}).slice(t?2:1);return!(!f.prod&&s.stop("B.rem",[["type of target",e,["array","object","undefined"],"oneOf",s.test.equal],"array"===e?["keys of array target",i,"integer","each"]:[],"object"===e?["keys of object target",i,"string","each"]:[]],function(e){f.error(t||{},"B.rem",e,"Path:",n)}))&&("object"===e&&a.go(i,function(e){delete r[e]}),"array"===e&&((i=s.copy(i)).sort(function(e,t){return t-e}),a.go(i,function(e){r.splice(e,1)})),!0)},a.go(["add","rem","set"],function(n){f.listen({id:n,verb:n,path:[]},function(e){var t="set"===n?f.get(e.path):s.copy(f.get(e.path));!1!==f[e.verb].apply(null,[e,e.path].concat(a.go(arguments,function(e){return e}).slice(1)))&&(s.eq(t,f.get(e.path))||f.say(e,"change",e.path))})}),f.str=function(e){var t=c(e);return"array"!==t&&"object"!==t?"string"===t?s.str(e):e+"":"array"===t?"["+a.go(e,f.str).join(", ")+"]":"{"+a.go(e,function(e,t){return s.str(t)+": "+f.str(e)}).join(", ")+"}"},f.evh=function(e){return a.obj(t.get(e),function(e,t){if(!t.match(/^on/))return[t,e]})},f.ev=function(){if("array"===c(arguments[0]))var t=arguments;else t=0===arguments.length?[]:[a.go(arguments,function(e){return e})];if(!f.prod&&s.stop("B.ev",a.go(t,function(e){return[["ev",e,"array"],function(){return[["ev.verb",e[0],"string"],function(){return!!u.isPath(e[1])||f.error("B.ev","Invalid path:",e[1],"Events:",t)}]}]}),function(e){f.error("B.ev",e,"Events:",t)}))return!1;var n='var id = B.say ("ev", event.type, B.evh (this));';return a.go(t,function(e){n+=' B.say ({"from": id}, '+a.go(2===e.length?e.concat({raw:"this.value"}):e,function(e,t){return 1<t&&"object"===c(e)&&"string"===c(e.raw)?e.raw:f.str(e)}).join(", ")+");"}),n},f.listen({id:"error",verb:"error",path:[]},function(e){f.prod||(document.body.innerHTML+=i.g(["div",{id:"errorwarning",style:i.css.style({position:"fixed","font-weight":"bold",bottom:20,left:.1,width:.8,padding:10,color:"white","background-color":"black","z-index":"10001","text-align":"center"})},"There was an error."]),setTimeout(function(){t("#errorwarning")&&document.body.removeChild(t("#errorwarning"))},3e3),f.eventlog())}),f.eventlog=function(){t("#eventlog")&&document.body.removeChild(t("#eventlog"));var n={},r=["maroon","red","olive","green","purple","fuchsia","teal","blue","black","gray","salmon","darkcyan","darkviolet","indigo","limegreen","coral","orangered"];document.body.innerHTML+=i.g(["table",{id:"eventlog",style:i.css.style({"border-collapse":"collapse","font-family":"serif","font-size":18,position:"absolute","right, top":4,width:Math.min(window.innerWidth,800),"z-index":"10000",border:"solid 4px #4488DD"})},[["style",["th, td",{"padding-left, padding-right":10,"border-bottom, border-right":"solid 1px black"}]],["tr",a.go(["ms","entry","from","verb","path","args"],function(e){return["th",{style:i.css.style({"background-color":"#bababa"})},e]})],a.go(f.log,function(e,t){return n[e.id]=t,["tr",{style:i.css.style({"background-color":{0:"#eaeaea",1:"#bababa"}[t%2]})},a.go([e.t-f.t,t,n[e.from],e.verb,e.path.join(":"),a.go(e.args,f.str).join(", ")],function(e,t){return 0===t?["td",e/1e3+(e%1e3?"":".0")+(e%100?"":"0")+(e%10?"":"0")+"s"]:1!==t&&2!==t?["td",e]:["td",{onclick:e===undefined?"":'c ("tr") ['+(e+1)+"].scrollIntoView ()",style:i.css.style({cursor:"pointer","font-weight":"bold",color:r[e%r.length]})},e===undefined?"":(2===t?"from ":"")+"#"+(e+1)]})]})]],!0),t("tr")[f.log.length].scrollIntoView()}}();