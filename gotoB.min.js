!function(){if("object"==typeof exports)var d=exports;else d=window.dale={};var p=function(){return Object.prototype.toString.call(arguments).match("arguments")}(),g=function(e,t){var n=typeof e;return"function"===n?Object.prototype.toString.call(e).match(/regexp/i)?"regex":"function":"object"!==n&&"number"!==n?n:e instanceof Array?"array":"number"===n?isNaN(e)?"nan":isFinite(e)?e%1==0?"integer":"float":"infinity":null===e?"null":"array"===(n=Object.prototype.toString.call(e).replace("[object ","").replace("]","").toLowerCase())||"date"===n?n:"regexp"===n?"regex":t?!p&&"function"===n(e.callee)?"arguments":n:"object"};try{d.clog=console.log.bind(console)}catch(t){d.clog=function(){var e=d.go(arguments,function(e){return e===undefined?"undefined":e}).join(" ");window.console?window.console.log(e):alert(e)}}var e=function(f){return function(e,t,n,r){if("go"===f)var i=t,o=!0===n,a=[],u=0;else if("fil"===f)i=n,o=!0===r,a=[],u=0;else if("obj"!==f)i=n,o=!0===r;else if("object"===g(t))i=n,o=!0===r,a=t;else i=t,o=!0===n,a={};if("function"!==g(i))return d.clog(("go"===f||"obj"===f&&"object"!==g(t)?"Second":"Third")+" argument passed to dale."+f+" must be a function but instead is",i,"with type",g(i)),!1;if(e===undefined)return a;var s=function(e){if("go"===f)a[u++]=e;else if("fil"===f)e!==t&&(a[u++]=e);else{if("obj"!==f)return a=e,"stop"===f?e===t:e!==t;if(e===undefined)return;if("array"!==g(e)||2!==e.length)return d.clog("array"===g(e)?"fun passed to dale.obj must return undefined or an array of length 2 but instead returned an array of length "+e.length:"fun passed to dale.obj must return undefined or an array of length 2 but instead returned a value of type "+g(e)),!(a=!1);a[e[0]]=e[1]}},c=g(e);if("object"===c&&("[object Arguments]"!==Object.prototype.toString.call(e)&&(p||"function"!==g(e.callee))||(c="array",e=[].slice.call(e))),"array"===c)for(var l=0;l<e.length&&!s(i(e[l],parseInt(l)));l++);else if("object"===c){for(var l in e)if((o||!e.hasOwnProperty||e.hasOwnProperty(l))&&s(i(e[l],l)))break}else s(i(e,0));return a}};d.go=e("go"),d.fil=e("fil"),d.obj=e("obj"),d.stop=e("stop"),d.stopNot=e("stopNot"),d.keys=function(e,t){return d.go(e,function(e,t){return t},t)},d.times=function(e,t,n){if(0===e)return[];if("integer"!==g(e)||e<0)return d.clog("steps must be a positive integer or zero."),!1;if(t===undefined)t=1;else if("integer"!==g(t)&&"float"!==g(t))return d.clog("start must be an integer or float."),!1;if(n===undefined)n=1;else if("integer"!==g(n)&&"float"!==g(n))return d.clog("step must be an integer or float."),!1;for(var r=[t];r.length<e;)t+=n,r.push(t);return r},d.acc=function(e,t,n,r){var i=arguments.length===("boolean"===g(arguments[arguments.length-1])?4:3),o=i?t:undefined,a=i?n:t,u=i?r:n;if("function"!==g(a))return d.clog("fun must be a function but instead is of type",g(a)),!1;var s=!0;return d.go(e,function(e,t){if(!i&&s)return s=!1,o=e;o=a(o,e)},u),o}}(),function(){var n="object"==typeof exports,y=n?require("dale"):window.dale;if(n)var b=exports;else b=window.teishi={};Array.prototype.indexOf||(Array.prototype.indexOf=function(n,r){var e=y.stopNot(this,undefined,function(e,t){if(!(r&&t<r))return n===e?t:void 0});return e===undefined?-1:e});var r=function(){return Object.prototype.toString.call(arguments).match("arguments")}();b.type=function(e,t){var n=typeof e;return"function"===n?Object.prototype.toString.call(e).match(/regexp/i)?"regex":"function":"object"!==n&&"number"!==n?n:e instanceof Array?"array":"number"===n?isNaN(e)?"nan":isFinite(e)?e%1==0?"integer":"float":"infinity":null===e?"null":"array"===(n=Object.prototype.toString.call(e).replace("[object ","").replace("]","").toLowerCase())||"date"===n?n:"regexp"===n?"regex":t?!r&&"function"===b.type(e.callee)?"arguments":n:"object"},b.str=function(){try{return JSON.stringify.apply(JSON.stringify,arguments)}catch(e){return!1}},b.parse=function(){try{return JSON.parse.apply(JSON.parse,arguments)}catch(e){return!1}},b.simple=function(e){var t=b.type(e);return"array"!==t&&"object"!==t},b.complex=function(e){return!b.simple(e)},b.copy=function(r,i){if(b.simple(r))return r;var e=b.type(r,!0),o="array"===e||"arguments"===e?[]:{};return y.go(r,function(e,t){if(b.simple(e))return o[t]=e;var n=i?i.concat():[r];return-1<n.indexOf(e)?o[t]="[Circular]":(n.push(e),o[t]=b.copy(e,n))}),o},b.eq=function(e,n){return b.simple(e)&&b.simple(n)?e===n:b.type(e,!0)===b.type(n,!0)&&(b.str(y.keys(e).sort())===b.str(y.keys(n).sort())&&!1!==y.stop(e,!1,function(e,t){return b.eq(e,n[t])}))},b.last=function(e,t){return-1===["array","arguments"].indexOf(b.type(e,!0))?b.clog("First argument passed to teishi.last must be array or arguments but instead has type "+b.type(e,!0)):t!==undefined&&("integer"!==b.type(t)||t<1)?b.clog("Second argument passed to teishi.last must be either undefined or an integer larger than 0."):e[e.length-(t||1)]},b.time=function(e){return arguments.length?new Date(e).getTime():(new Date).getTime()};var i,l=function(){return n?"[0m":""},f=function(){return n?"[1m":""},d=function(){return n?"[37m":""},p=function(e){if(!n)return"";for(var t=i;i===t;)t=Math.round(5*Math.random()+1);return"["+(e?"4":"3")+(i=t)+"m"};b.clog=function(){var s=f();!function c(e,i){var o=b.type(e),a=(i=i||0,!0);"object"===o&&"[object Arguments]"===Object.prototype.toString.call(e)&&(o="array");var u=i<2?"":"\n"+y.go(y.times(i-1),function(e){return"   "}).join("");0<i&&(s+="array"===o?d()+"[":d()+"{"),y.go(e,function(e,t){var n=b.type(e);if(0===i&&0===t&&("string"===n||"integer"===n))return s+=p(!(a=!1))+e+":"+l()+f();if(a||(s+=d()+(0===i?" ":", ")),a=!1,"string"===n&&0<i&&(e="'"+e+"'"),"function"===n){var r=(e+="").match(/\s+(?=}$)/);null!==r&&(e=e.replace(new RegExp(r[0],"g"),"\n")),150<e.length&&(e=e.slice(0,150)+"...\n"),1<i&&(e=e.replace(/\n/g,"array"===o?u:"\n"+(t+": ").replace(/./g," ")+u.slice(1)))}s+=p(),"object"===o&&(s+=u+(t.match(/^[0-9a-zA-Z_]+$/)?t:"'"+t+"'")+": "),"array"===n||"object"===n?c(e,i+1):s+="object"===o?e:u+e}),0<i&&("array"===o&&(s+=(1<i?"\n":"")+u.slice(4)+d()+"]"),"object"===o&&(s+=(1<i?"\n":"")+u.slice(4)+d()+"}"))}(b.copy(arguments));var e=new Date;return y.clog("("+e[e.toISOString?"toISOString":"toString"]()+")",s+l()),!1},b.lno=function(){n=!1},b.makeTest=function(c,l){if("function"!==b.type(c))return b.clog("teishi.makeTest","fun passed to teishi.makeTest should be a function but instead is",c,"with type",b.type(c));if("string"===b.type(l)&&(l=[l]),"array"!==b.type(l))return b.clog("teishi.makeTest","clauses argument passed to teishi.makeTest should be an array but instead is",l,"with type",b.type(l));if("string"!==b.type(l[0]))return b.clog("teishi.makeTest","shouldClause passed to teishi.makeTest should be a string but instead is",l[0],"with type",b.type(l[0]));if(l[1]!==undefined&&("array"!==b.type(l[1])&&(l[1]=[l[1]]),!0!==y.stopNot(l[1],!0,function(e){var t=b.type(e);return"string"===t||"function"===t||b.clog("teishi.makeTest","Each finalClause passed to teishi.makeTest should be a string or a function but instead is",e,"with type",t)})))return;return function(e,t,n,r,i,o){var a=c(n,r);if(!0===a)return!0;if("array"===b.type(a))return a;var u=[],s=0;return i!==undefined&&(u[s++]="each of the"),t[0]&&(u[s++]=t[0]),e&&(u[s++]="passed to",u[s++]=e),u[s++]=l[0],o!==undefined&&(u[s++]="one of"),u[s++]=o!==undefined?o:r,t[1]&&(u[s++]="("+t[1]+")"),u[s++]=i!==undefined?"but one of":"but instead",i!==undefined&&(u[s++]=i),u[s++]="is",u[s++]=n,y.go(l[1],function(e){u[s++]="function"!=typeof e?e:e(n,r)}),u}},b.test={type:b.makeTest(function(e,t){return b.type(e)===t},["should have as type",["with type",b.type]]),equal:b.makeTest(b.eq,"should be equal to"),notEqual:b.makeTest(function(e,t){return!b.eq(e,t)},"should not be equal to"),range:b.makeTest(function(n,e){return"object"!==b.type(e,!0)?["Range options object must be an object but instead is",e,"with type",b.type(e,!0)]:"{}"===b.str(e)||y.stopNot(e,!0,function(e,t){return"min"!==t&&"max"!==t&&"less"!==t&&"more"!==t?['Range options must be one of "min", "max", "less" and "more", but instead is',t]:"min"===t?e<=n:"max"===t?n<=e:"less"===t?n<e:e<n})},"should be in range"),match:b.makeTest(function(e,t){return"string"!==b.type(e)?["Invalid comparison string passed to teishi.test.match. Comparison string must be of type string but instead is",e,"with type",b.type(e)]:"regex"!==b.type(t)?["Invalid regex passed to teishi.test.match. Regex must be of type regex but instead is",t,"with type",b.type(t)]:null!==e.match(t)},"should match")},b.validateRule=function(r){var e=b.type(r);if("function"===e||"boolean"===e)return!0;if("array"!==e)return["each teishi rule must be an array or boolean or function but instead is",r,"with type",e];var i,o,t=b.type(r[0]);return"string"!==t&&("array"!==t||2!==r[0].length||"string"!==b.type(r[0][0])||"string"!==b.type(r[0][1]))||(3===r.length||(r.length<3||5<r.length?["Each teishi simple rule must be an array of length between 3 and 5, but instead is",r,"and has length",r.length]:y.stopNot(r,!0,function(e,t){if(t<3)return!0;var n=b.type(e);if("string"===n){if("oneOf"!==e&&"each"!==e&&"eachOf"!==e)return["Invalid multi parameter",e,". Valid multi parameters are",["oneOf","each","eachOf"]];if(o)return["You can pass only one multi parameter to a teishi simple rule but instead you passed two:",r[3],"and",r[4]];o=e}else{if("function"!==n)return["Elements #4 and #5 of a teishi simple rule must be either a string or a function, but element","#"+(t+1),"is",e,"and has type",n];if(i)return["You can pass only one test function to a teishi simple rule but instead you passed two:",r[3],"and",r[4]];i=e}return!0})))};var v=function(e,t){return t===undefined?b.clog.apply(b.clog,["teishi.v"].concat(e)):(e=y.go(e,function(e){return b.complex(e)?b.str(e):e+""}).join(" "),!0===t?e:(t(e),!1))};b.v=function(e,t,n){if("string"===b.type(e))var r=e,i=t,o=n;else r="",i=e,o=t;if(o!==undefined&&!0!==o&&"function"!==b.type(o))return b.clog("teishi.v","Invalid apres argument. Must be either undefined, true, or a function.");var a=b.validateRule(i);if(!0!==a)return v(a,o);var u=b.type(i);if("boolean"===u)return i;if("function"===u)return b.v(r,i(),o);if(0===i.length)return!0;var s=b.type(i[0]);if("boolean"===s&&2===i.length&&"array"===b.type(i[1]))return!1===i[0]||b.v(r,i[1],o);if("string"!==s&&("array"!==s||2!==i[0].length||"string"!==b.type(i[0][0])||"string"!==b.type(i[0][1])))return y.stopNot(i,!0,function(e){return b.v(r,e,o)});var c,l=b.type(i[3]),f=b.type(i[4]),d="function"===l?i[3]:"function"===f?i[4]:b.test.type,p="string"===l?i[3]:"string"===f?i[4]:undefined,g="array"===s?i[0]:[i[0]],h=b.type(i[1],!0),m=b.type(i[2],!0);return("each"===p||"eachOf"===p)&&("array"===h&&0===i[1].length||"object"===h&&0===y.keys(i[1]).length||i[1]===undefined)||(!0===(c="oneOf"!==p&&"eachOf"!==p||!("array"===m&&0===i[2].length||"object"===m&&0===y.keys(i[2]).length||i[2]===undefined)?p===undefined?d(r,g,i[1],i[2]):"each"===p?y.stopNot(i[1],!0,function(e){return d(r,g,e,i[2],i[1])}):"oneOf"===p?y.stop(i[2],!0,function(e){return d(r,g,i[1],e,undefined,i[2])}):y.stopNot(i[1],!0,function(t){return y.stop(i[2],!0,function(e){return d(r,g,t,e,i[1],i[2])})}):["To field of teishi rule is",i.to,"but multi attribute",p,"requires it to be non-empty, at teishi step",i])||v(c,o))},b.stop=function(){return!0!==b.v.apply(b.v,arguments)}}(),function(){var e="object"==typeof exports,s=e?require("dale"):window.dale,i=e?require("teishi"):window.teishi;if(e)var c=exports;else c=window.lith={};var l=i.type,f=i.clog;c.k={lithbagElements:["string","integer","float","array","undefined"],tags:["!DOCTYPE HTML","LITERAL","a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],voidTags:["!DOCTYPE HTML","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]},c.entityify=function(e,t){return!(!t&&i.stop("lith.entityify",["Entityified string",e,"string"]))&&e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;")},c.v=function(t){var e=l(t);if("array"===e&&"string"===l(t[0])&&-1<c.k.tags.indexOf(t[0])){var n="object"===l(t[1])?t[1]:undefined,r=t[n?2:1];return!!i.v([["lith length",t.length,{min:1,max:3},i.test.range],[n===undefined,["length of lith without attributes",t.length,{max:2},i.test.range]],[["lith attribute keys","start with an ASCII letter, underscore or colon, and be followed by letters, digits, underscores, colons, periods, dashes, extended ASCII characters, or any non-ASCII characters."],s.keys(n),/^[a-zA-Z_:][a-zA-Z_:0-9.\-\u0080-\uffff]*$/,"each",i.test.match],["lith attribute values",n,["string","integer","float","undefined","null","boolean"],"eachOf"],["lith contents",r,c.k.lithbagElements,"oneOf"]],function(e){f("lith.v - Invalid lith",{error:e,"original input":t})})&&"Lith"}return!!i.v([["lithbag",e,c.k.lithbagElements,"oneOf",i.test.equal],["array"===e,["lithbag elements",t,c.k.lithbagElements,"eachOf"]]],function(e){f("lith.v - Invalid lithbag",{error:e,"original input":t})})&&"Lithbag"},c.g=function(e,t){if(t||c.prod)return!0!==(t||c.prod)?f("lith.g","prod or lith.prod must be true or undefined."):"array"===l(e)&&-1<c.k.tags.indexOf(e[0])?c.generateLith(e,!0):c.generateLithbag(e,!1,!0);var n=c.v(e);return!!n&&c["generate"+n](e)},c.generateLithbag=function(e,n,r){var i="";return!1!==s.stop(e,!1,function(e){if(e!==undefined){l(e);if("array"!==l(e))return i+=n?e:c.entityify(e+"",r);var t=c.g(e,r);if(!1===t)return!1;i+=t}})&&i},c.generateLith=function(e,n){var t="object"===l(e[1])?e[1]:undefined,r=e[t?2:1];if("LITERAL"===e[0])return r;var i="<"+e[0];if(s.go(t,function(e,t){!e&&0!==e||(i+=" "+c.entityify(t+"",n)+'="'+c.entityify(e+"",n)+'"')}),i+=">","array"===l(r)){var o="style"===e[0]?c.css.g(r,n):c.g(r,n);if(!1===o)return!1;i+=o}else i+=c.generateLithbag(r,"style"===e[0]||"script"===e[0],n);return-1===c.k.voidTags.indexOf(e[0])&&(i+="</"+e[0]+">"),i},c.css={},c.css.v=function(t){if(i.stop(["litc or litcbag",t,"array"],function(e){f("lith.css.v - Invalid litc or litcbag",{error:e,"original input":t})}))return!1;if(0===t.length||"array"===l(t[0]))return!0;var e="object"===l(t[1])?t[1]:undefined,n=t[e?2:1];return i.v([["litc length",t.length,{min:1,max:3},i.test.range],[e===undefined,["length of litc without attributes",t.length,{max:2},i.test.range]],["litc selector",t[0],"string"],c.css.vAttributes(e),["LITERAL"!==t[0],["litc contents",n,["undefined","array"],"oneOf"]]],function(e){f("lith.css.v - Invalid litc",{error:e,"original input":t})})},c.css.vAttributes=function(e){return i.v([["litc attribute values",e,["string","integer","float","object","undefined","null","boolean"],"eachOf"]])},c.css.g=function(e,r,i){if(r||c.prod){if(!0!==(r||c.prod))return f("lith.css.g","prod or lith.prod must be true or undefined.");r=!0}if(!r&&!1===c.css.v(e))return!1;if(0===e.length)return"";if("LITERAL"===e[0])return e[1];var o="";if("array"===l(e[0]))return!1!==s.stop(e,!1,function(e,t){var n=c.css.g(e,r,i);if(!1===n)return!1;o+=n})&&o;i===undefined&&(i="");var t="object"===l(e[1])?e[1]:undefined,n=e[t?2:1];i=s.go(i.split(/,\s*/),function(t){return s.go(e[0].split(/,\s*/),function(e){return e.match(/&/)?e.replace("&",t):t+(0===t.length?"":" ")+e}).join(", ")}).join(", "),o+=i+"{";var a=function(e){return!1!==c.css.vAttributes(e)&&s.stop(e,!1,function(t,e){if(t||0===t){var n=l(t);if("object"===n)return a(t);"integer"===n&&(t<0||1<t)&&(t+="px"),"float"!==n&&1!==t||(t=100*t+"%"),s.go(e.split(/,\s*/),function(e){o+=e+":"+t+";"})}})};if(!1===a(t))return!1;if(o===i+"{"?o="":o+="}",n){var u=c.css.g(n,r,i);if(!1===u)return!1;o+=u}return o},c.css.media=function(e,t){return!i.stop(["selector",e,"string"])&&[["LITERAL","@media "+e+" {"],t,["LITERAL","}"]]},c.css.style=function(e,t){var n=c.css.g(["",e],t);return!1===n?n:n.slice(1,-1)}}(),function(){var e="object"==typeof exports,u=e?require("dale"):window.dale,s=e?require("teishi"):window.teishi,c=s.type,t=s.clog,n=function(e){if(!s.stop([["store",e,["array","object","undefined"],"oneOf"]])){var a={listeners:{},store:e||{},log:[],error:t,count:0,say:function(){var t="object"===c(arguments[0])?arguments[0]:undefined,e=arguments[t?1:0],n=arguments[t?2:1];if(s.simple(n)&&(n=[n]),!a.prod&&s.stop("r.say",[["context",t,["object","undefined"],"oneOf"],[t!==undefined,[function(){return["x.from",t.from,["string","undefined"],"oneOf"]}]],["verb",e,"string"]],function(e){a.error(t,"r.say",e)}))return!1;if(!a.prod&&!a.isPath(n))return a.error(t,"r.say","Invalid path. Arguments:",{verb:e,path:n});var r=arguments,i=arguments.length===(t?3:2)?undefined:u.go(u.times(arguments.length-(t?3:2),t?3:2),function(e){return r[e]}),o=t?t.from:undefined;return t={from:"E"+a.random(),verb:e,path:n,args:i},a.logpush(o,t.from,e,n,i),a.mill(i===undefined?[t]:[t].concat(i)),t.from},listen:function(){var e,t=arguments[arguments.length-1];if(arguments.length<2)return a.error("r.listen","Too few arguments passed to r.listen");if(2===arguments.length?e=arguments[0]:((e=3===arguments.length?{}:arguments[2]).verb=arguments[0],e.path=arguments[1]),s.simple(e.path)&&(e.path=[e.path]),!a.prod&&s.stop("r.listen",[["options",e,"object"],["keys of options",u.keys(e),["verb","path","id","parent","priority","burn","match"],"eachOf",s.test.equal],function(){return[["options.verb",e.verb,["string","regex"],"oneOf"],["options.id",e.id,["string","integer","undefined"],"oneOf"],["options.parent",e.parent,["string","integer","undefined"],"oneOf"],["options.priority",e.priority,["undefined","integer"],"oneOf"],["options.burn",e.burn,["undefined","boolean"],"oneOf"],["options.match",e.match,["undefined","function"],"oneOf"]]},["listener function",t,"function"]],function(e){a.error("r.listen",e)}))return!1;if(!a.prod&&!a.isPath(e.path,!0))return a.error("r.listen","Invalid path. Options:",e);if(e.id!==undefined){if(e.id+="",!a.prod&&a.listeners[e.id])return a.error("r.listen","A listener with id",e.id,"already exists.")}else e.id=a.random();return e.lfun=t,e.index=a.count++,(a.listeners[e.id]=e).id},forget:function(n,r){if(!a.prod&&r!==undefined&&"function"!==c(r))return a.error("r.forget","Second argument to r.forget must be a function or undefined. Id is:",n);if(!a.prod&&!a.listeners[n])return a.error("r.forget","Listener",n,"does not exist.");var e=a.listeners[n];delete a.listeners[n],r&&r(e),u.go(a.listeners,function(e,t){e.parent===n&&a.forget(t,r)})},isPath:function(e,t){return s.v([["path",e,["array","integer","string"].concat(t?"regex":[]),"oneOf"],["path",e,["integer","string"].concat(t?"regex":[]),"eachOf"]],function(){})},random:function(){return Math.random().toString(16).slice(2)},compare:function(e,t){return"*"===e||"*"===t||("regex"===c(e)?null!==(t+"").match(e):e===t)},logpush:function(e,t,n,r,i){a.log&&a.log.push({t:s.time(),from:e,id:t,verb:n,path:r,args:i})},mill:function(n){var r=function(e){if(0!==e.length){n[0].cb=function(){r(e)};var t=e.shift();if(n[0].listener=t,!a.listeners[t.id])return r(e);t.burn&&a.forget(t.id),"function"!==c(t.lfun.apply(null,n))&&r(e)}};r(a.sort(a.match(n[0].verb,n[0].path,a.listeners)))},match:function(e,n,t){var r=[];return u.go(t,function(t){if(!t.disabled){if(t.match)return!0===t.match(t,{verb:e,path:n})?r.push(t):undefined;if(a.compare(t.verb,e))return 0===t.path.length||0===n.length?r.push(t):void(u.stop(u.times(Math.min(t.path.length,n.length),0),!1,function(e){return a.compare(t.path[e],n[e])})&&r.push(t))}}),r},sort:function(e){return e.sort(function(e,t){var n=(t.priority||0)-(e.priority||0);return 0!=n?n:e.index-t.index})}};return a}};e?module.exports=n:window.R=n}(),function(){if("object"==typeof exports)return console.log("cocholate only works in a browser!");var u=window.dale,s=window.teishi,c=s.type,l=s.clog;document.createElement("_").insertAdjacentHTML||(HTMLElement.prototype.insertAdjacentHTML=function(e,t){var n=document.createElement("div");for(n.innerHTML=t;n.firstChild;)"beforeBegin"===e?this.parentNode.insertBefore(n.firstChild,this):"afterBegin"===e?this.insertBefore(n.firstChild,this.firstChild):"beforeEnd"===e?this.appendChild(n.firstChild):this.parentNode.insertBefore(n.firstChild,this.nextElementSibling)});var f=window.c=function(e,t){if(s.stop("c",["fun",t,["function","undefined"],"oneOf"]))return!1;var n=e&&e.nodeName,r=n?[e]:f.find(e);if(!1===r)return!1;if(t){var i=u.go(arguments,function(e){return e}).slice(2);r=u.go(r,function(e){return t.apply(undefined,[e].concat(i))})}return n||"body"===e||"string"===c(e)&&e.match(/^[a-z0-9]*#[^\s\[>,:]+$/)?r[0]:r};f.nodeListToArray=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},f.setop=function(e,t,n){if("and"===e)return u.fil(t,undefined,function(e){return-1<n.indexOf(e)?e:undefined});var r=t.slice();return"or"===e?u.go(n,function(e){-1===r.indexOf(n)&&r.push(e)}):(0===r.length&&(r=f.nodeListToArray(document.getElementsByTagName("*"))),u.go(n,function(e){var t=r.indexOf(e);-1<t&&r.splice(t,1)})),r},f.find=function(t){var e=c(t);if(s.stop("cocholate",[["selector",t,["array","string","object"],"oneOf"],function(){return[["array"===e,["first element of array selector",t[0],[":and",":or",":not"],"oneOf",s.test.equal]],["object"===e,[["selector keys",u.keys(t),["selector","from"],"eachOf",s.test.equal],["selector.selector",t.selector,["array","string"],"oneOf"],function(){return!("object"!==c(t.from)||document.querySelectorAll&&!t.from.querySelectorAll)||l("teishi.v","selector.from passed to cocholate must be a DOM element.")}]]]}]))return!1;if("array"!==e){if(document.querySelectorAll&&"string"===e)return f.nodeListToArray(document.querySelectorAll(t));if(document.querySelectorAll&&"object"===e)return f.nodeListToArray(t.from.querySelectorAll(t.selector));var n=t.from?t.from:document;if("*"!==(t="string"===e?t:t.selector)&&!t.match(/^[a-z0-9]*(#|\.)?[a-z0-9]+$/i))return l("The selector "+t+" is not supported in IE <= 7 or Firefox <= 3.");var r=t.match("#")?"id":t.match(/\./)?"class":undefined,i=2!==(t=t.split(/#|\./)).length&&r?undefined:t[0].toUpperCase();return u.fil(f.nodeListToArray(n.getElementsByTagName(i||"*")),undefined,function(e){if(!("class"===r&&-1===(e.className||"").split(/\s/).indexOf(s.last(t))||"id"===r&&e.id!==s.last(t)))return e})}var o=t.shift(),a=[];return u.stop(t,!1,function(e,t){var n=f.find(e);if(!1===n)return a=!1;a=0===t&&":not"!==o?n:f.setop(o.replace(":",""),a,n)}),a},f.empty=function(e){f(e,function(e){u.go(f.nodeListToArray(e.getElementsByTagName("*")),function(e){e.parentNode&&e.parentNode.removeChild(e)})})},f.fill=function(e,t){if(s.stop("c.fill",["html",t,"string"]))return!1;f.empty(e),f(e,function(e){e.innerHTML=t})},f.place=function(e,t,n){if(s.stop("c.place",[["where",t,["beforeBegin","afterBegin","beforeEnd","afterEnd"],"oneOf",s.test.equal],["html",n,"string"]]))return!1;f(e,function(e){e.insertAdjacentHTML(t,n)})},f.get=function(e,n,r){if(s.stop("c.get",["attributes",n,["string","array","undefined"],"oneOf"]))return!1;var i=[null,"",!1,0,"false"];return f(e,function(t){return n!==undefined?u.obj(n,function(e){return r?[e,t.style[e]||null]:[e,t.getAttribute(e)]}):r?u.obj(t.style.length?u.times(t.style.length,0):u.keys(t.style),function(e){return t.style.length?[t.style[e],t.style[t.style[e]]]:-1===i.indexOf(t.style[e])?[e,t.style[e]]:void 0}):u.obj(t.attributes,{"class":t["class"]||t.className},function(e,t){if(e&&e.nodeName&&-1===i.indexOf(e.nodeValue))return[e.nodeName,e.nodeValue]})})},f.set=function(e,t,r,i){if(s.stop("c.set",[["attributes",t,"object"],[["attribute keys","start with an ASCII letter, underscore or colon, and be followed by letters, digits, underscores, colons, periods, dashes, extended ASCII characters, or any non-ASCII characters."],u.keys(t),/^[a-zA-Z_:][a-zA-Z_:0-9.\-\u0080-\uffff]*$/,"each",s.test.match],["attribute values",t,["integer","float","string","null"],"eachOf"]]))return!1;f(e,function(n){u.go(t,function(e,t){r?n.style[t]=null===e?"":e:null===e?n.removeAttribute(t):n.setAttribute(t,e)}),n.onchange&&!i&&n.onchange()})},f.fire=function(e,r){if(s.stop("c.fire",["event type",r,"string"]))return!1;f(e,function(e){var t;try{t=new Event(r)}catch(n){t=document.createEvent?document.createEvent("Event"):document.createEventObject(),document.createEvent&&t.initEvent(r,!1,!1)}return e.dispatchEvent?e.dispatchEvent(t):e.fireEvent?e.fireEvent(r,t):l("c.fire error","Unfortunately, this browser supports neither EventTarget.dispatchEvent nor element.fireEvent.")})},f.ready=function(e){if(window.addEventListener)return window.addEventListener("load",e,!1);if(window.attachEvent)return window.attachEvent("onload",e);var t=setInterval(function(){"complete"===document.readyState&&(e()||clearInterval(t))},10)},f.cookie=function(e){return!1===e?u.go(document.cookie.split(/;\s*/),function(e){return document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()),e}):u.obj((e||document.cookie).split(/;\s*/),function(e){if(""!==e)return[(e=e.split("="))[0],e.slice(1).join("=")]})},f.ajax=function(e,t,n,r,i){if(e=e||"GET",n=n||{},r=r||"",i=i||function(){},s.stop("c.ajax",[["method",e,"string"],["path",t,"string"],["headers",n,"object"],["callback",i,"function"]]))return!1;var o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return o.open(e.toUpperCase(),t,!0),s.complex(r)&&"formdata"!==c(r,!0)&&(n["content-type"]=n["content-type"]||"application/json",r=s.str(r)),u.go(n,function(e,t){o.setRequestHeader(t,e)}),o.onreadystatechange=function(){if(4===o.readyState){if(200!==o.status&&304!==o.status)return i(o);var r,e={xhr:o,headers:u.obj(o.getAllResponseHeaders().split(/\r?\n/),function(e){if(""!==e){var t=e.match(/^[^:]+/)[0],n=e.replace(t,"").replace(/:\s+/,"");return t.match(/^content-type/i)&&n.match(/application\/json/i)&&(r=!0),[t,n]}})};e.body=r?s.parse(o.responseText):o.responseText,i(null,e)}},o.send(r),{headers:n,body:r,xhr:o}},f.loadScript=function(e,r){f.ajax("get",e,{},"",function(e,t){if(e)return r(e);var n=document.createElement("script");try{n.appendChild(document.createTextNode(t.body))}catch(e){n.text=t.body}document.body.appendChild(n),r(null,t)})}}(),function(){if("object"==typeof exports)return console.log("gotoв only works in a browser!");var y=window.dale,b=window.teishi,v=window.lith,c=window.R(),i=window.c,w=b.type,j=window.B={v:"2.0.0",B:"в",t:b.time(),r:c,listeners:c.listeners,store:c.store,log:c.log,say:c.say,listen:c.listen,forget:c.forget};c.error=j.error=function(){var e="object"===w(arguments[0])?arguments[0]:undefined,t=y.go(arguments,function(e){return e}).slice(e?1:0);return j.say.apply(null,[e||{},"error"].concat(t)),!1},j.listen({id:"error",verb:"error",path:[],match:function(e){return"error"===e.verb}},function(){document.body.innerHTML+=v.g(["div",{id:"eventlog-snackbar",style:v.css.style({position:"fixed","font-weight":"bold",opacity:"0.8",top:0,left:.1,width:.8,padding:10,color:"white","background-color":"black","z-index":"10001","text-align":"center"})},"There was an error."],!0),setTimeout(function(){i("#eventlog-snackbar")&&document.body.removeChild(i("#eventlog-snackbar"))},3e3),j.eventlog()}),j.eventlog=function(){i("#eventlog")&&document.body.removeChild(i("#eventlog"));var n={},r=["maroon","red","olive","green","purple","fuchsia","teal","blue","black","gray","salmon","darkcyan","darkviolet","indigo","limegreen","coral","orangered"];document.body.innerHTML+=v.g(["table",{id:"eventlog"},[["style",["#eventlog",{"border-collapse":"collapse","font-family":"serif","font-size":18,position:"absolute","right, top":4,width:Math.min(window.innerWidth,800),"z-index":"10000",border:"solid 4px #4488DD"},["th, td",{"padding-left, padding-right":10,"border-bottom, border-right":"solid 1px black"}]]],["tr",y.go(["ms","entry","from","verb","path","args"],function(e){return["th",{style:v.css.style({"background-color":"#bababa"})},e]})],y.go(j.log,function(e,t){return n[e.id]=t,["tr",{style:v.css.style({"background-color":{0:"#eaeaea",1:"#bababa"}[t%2]})},y.go([e.t-j.t,t,n[e.from],e.verb,e.path.join(":"),y.go(e.args,j.str).join(", ")],function(e,t){return 0===t?["td",e/1e3+(e%1e3?"":".0")+(e%100?"":"0")+(e%10?"":"0")+"s"]:1!==t&&2!==t?["td",e]:["td",{onclick:e===undefined?"":'c ("tr") ['+(e+1)+"].scrollIntoView ()",style:v.css.style({cursor:"pointer","font-weight":"bold",color:r[e%r.length]})},e===undefined?"":(2===t?"from ":"")+"#"+(e+1)]})]})]],!0),i("tr")[j.log.length].scrollIntoView()},j.get=function(){var n="array"===w(arguments[0])?arguments[0]:y.go(arguments,function(e){return e});if(!j.prod&&!c.isPath(n))return j.error("B.get","Invalid path:",n)||undefined;var r=j.store;return!1===y.stop(n,!1,function(e,t){if(t<n.length-1&&b.simple(r[e]))return!1;r=r[e]})?undefined:r},j.set=function(){var e="object"===w(arguments[0])?arguments[0]:undefined,r=arguments[e?1:0],i=arguments[e?2:1];if(!j.prod&&!c.isPath(r))return j.error(e||{},"B.set","Invalid path:",r);if("array"!==w(r)&&(r=[r]),0===r.length)return!j.prod&&b.simple(i)?j.error(e||{},"B.set","Cannot set B.store to something that is not an array or object."):(j.store=i,!0);var t="string"===w(r[0])?"object":"array";w(j.store)!==t&&(j.store="object"==t?{}:[]);var o=j.store;return y.go(r,function(e,t){if(t===r.length-1)return o[e]=i;var n="string"===w(r[t+1])?"object":"array";w(o[e])!==n&&(o[e]="object"==n?{}:[]),o=o[e]}),!0},j.add=function(){var n="object"===w(arguments[0])?arguments[0]:undefined,e=arguments[n?1:0];if(!j.prod&&!c.isPath(e))return j.error(n||{},"B.add","Invalid path:",e);j.get(e)===undefined&&j.set(e,[]);var r=j.get(e);return j.prod||"array"===w(r)?(y.go(arguments,function(e,t){(n?1:0)<t&&r.push(e)}),!0):j.error(n||{},"B.add","Cannot add to something that is not an array. Path:",e)},j.rem=function(){var t="object"===w(arguments[0])?arguments[0]:undefined,n=arguments[t?1:0];if(!j.prod&&!c.isPath(n))return j.error(t||{},"B.rem","Invalid path:",n);var r=j.get(n),e=w(r),i="array"===w(arguments[t?2:1])?arguments[t?2:1]:y.go(arguments,function(e){return e}).slice(t?2:1);return!(!j.prod&&b.stop("B.rem",[["type of target",e,["array","object","undefined"],"oneOf",b.test.equal],"array"===e?["keys of array target",i,"integer","each"]:[],"object"===e?["keys of object target",i,"string","each"]:[]],function(e){j.error(t||{},"B.rem",e,"Path:",n)}))&&("object"===e&&y.go(i,function(e){delete r[e]}),"array"===e&&((i=b.copy(i)).sort(function(e,t){return t-e}),y.go(i,function(e){r.splice(e,1)})),!0)},y.go(["add","rem","set"],function(n){j.listen({id:n,verb:n,path:[],match:function(e,t){return c.compare(e.verb,t.verb)}},function(e){var t="set"===n?j.get(e.path):b.copy(j.get(e.path));!1!==j[e.verb].apply(null,[e,e.path].concat(y.go(arguments,function(e){return e}).slice(1)))&&(b.eq(t,j.get(e.path))||j.say(e,"change",e.path,t))})}),j.changed=function(e,t,n){if(t.length>=n.length)return!0;var r=e;return y.stop(n.slice(t.length),!1,function(e){if(b.simple(r))return r=undefined,!1;r=r[e]}),!b.eq(r,j.get(n))},j.changeListener=function(t,n,e){return!!c.compare(t.verb,n.verb)&&(!(0!==t.path.length&&0!==n.path.length&&!y.stop(y.times(Math.min(t.path.length,n.path.length),0),!1,function(e){return c.compare(t.path[e],n.path[e])}))&&j.changed(e,t.path,n.path))},j.str=function(e){var t=w(e);return"array"!==t&&"object"!==t?"string"===t?b.str(e):e+"":"array"===t?"["+y.go(e,j.str).join(", ")+"]":"{"+y.go(e,function(e,t){return b.str(t)+": "+j.str(e)}).join(", ")+"}"},j.evh=function(e){return y.obj(i.get(e),function(e,t){if(!t.match(/^on/))return[t,e]})},j.ev=function(){if("array"===w(arguments[0]))var t=arguments;else t=0===arguments.length?[]:[y.go(arguments,function(e){return e})];if(!j.prod&&b.stop("B.ev",y.go(t,function(e){return[["ev",e,"array"],function(){return[["ev.verb",e[0],"string"],function(){return!!c.isPath(e[1])||j.error("B.ev","Invalid path:",e[1],"Events:",t)}]}]}),function(e){j.error("B.ev",e,"Events:",t)}))return!1;var n='var id = B.say ("ev", event.type, B.evh (this));';return y.go(t,function(e){n+=' B.say ({"from": id}, '+y.go(2===e.length?e.concat({raw:"this.value"}):e,function(e,t){return 1<t&&"object"===w(e)&&"string"===w(e.raw)?e.raw:j.str(e)}).join(", ")+");"}),n},j.mount=function(e,t){if(!j.prod&&"string"!==w(e)||!e.match(/^(body|[a-z0-9]*#[^\s\[>,:]+)$/))return j.error("B.mount","Target must be either 'body' or an id selector, but instead is "+e);var n="body"===e?document.body:document.getElementById(e.replace(/.*#/g,""));if(!j.prod){if(!n)return j.error("B.mount","Target not found:",e);if("function"!==w(t))return j.error("B.mount","fun must be a function but instead is",t)}n=t();if(!j.prod&&n!==undefined){var r=j.validateLith(n);if("Lith"!==r&&"Lithbag"!==r)return j.error("B.mount","function returned invalid lith or lithbag",r)}n&&i.place(e,"afterBegin",v.g(n,!0))},j.unmount=function(e){if(!j.prod&&"string"!==w(e)||!e.match(/^(body|[a-z0-9]*#[^\s\[>,:]+)$/))return j.error("B.unmount","Target must be either 'body' or an id selector, but instead is "+e);var t="body"===e?document.body:document.getElementById(e.replace(/.*#/g,""));if(!j.prod&&!t)return j.error("B.unmount","Target not found:",e);i({selector:"*",from:t},function(e){e.id&&e.id.match(/^в[0-9a-f]+$/g)&&j.listeners[e.id]&&j.forget(e.id)}),t.innerHTML=""},j.elem=function(a,t){if("array"===w(a)&&"array"!==w(a[0])&&(a=[a]),!j.prod&&b.stop("B.elem",[y.stopNot(a,!1,function(e){return!!c.isPath(e)||j.error("B.elem","Invalid path:",e,"Arguments",{paths:a,options:options,fun:t})}),["fun",t,"function"]]))return!1;var u=j.B+j.internal.count++,s=function(){var n=j.internal.count,r=[],e=t.apply(null,y.go(a,j.get));if(e!==undefined){if(!j.prod&&"Lith"!==j.validateLith(e))return j.error("B.elem","Function must return a lith element but instead is:",e,"Arguments:",{paths:a,fun:t});y.go(y.times(j.internal.count-n,1),function(e){var t=j.listeners[j.B+n+e];t.priority--,t.parent||(r.push(t.id),t.parent=u)}),"object"!==w(e[1])&&e.splice(1,0,{}),e[1].id=u,e[1].paths=y.go(a,function(e){return e.join(":")}).join(", ")}return j.listeners[u].elem=e,j.listeners[u].children=r,e};return j.listen("change",[],{id:u,priority:-1,match:function(e){return"change"===e.verb}},function(n,t,r){var e=y.fil(a,undefined,function(t){return 0===n.path.length||0===t.length||y.stop(y.times(Math.min(n.path.length,t.length),0),!1,function(e){return c.compare(n.path[e],t[e])})?t:void 0});if(y.stopNot(e,undefined,function(e){return r||j.changed(t,n.path,e)?e:void 0})){var i=j.listeners[u].elem,o=j.listeners[u].children;s()&&j.redraw(n,u,i,o)}}),s()},j.internal={count:1,timeout:200,queue:[],redrawing:!1},j.validateLith=function(e){var t=v.v(e,!0);return"Lith"!==t&&"Lithbag"!==t?t:"Lith"===t?"array"===w(b.last(e))?j.validateLith(b.last(e)):"Lith":y.stopNot(e,undefined,function(e){if("array"===w(e)){var t=j.validateLith(e);return"Lith"!==t||"Lithbag"!==t?t:void 0}})||"Lithbag"},j.redraw=function(e,t,n,r,i){if(j.internal.redrawing&&!i)return j.internal.queue.push([e,t,n,r]);j.internal.redrawing=!0;var o=j.listeners[t],a=document.getElementById(t);if(!j.prod&&!a)return j.forget(t),j.error(e,"B.redraw","Attempted to redraw dangling element, omitting redraw & deleting listener.",{listener:o});var u,s=j.diff(j.prediff(n),j.prediff(o.elem));y.go(r,function(e){j.forget(e)}),s?j.applyDiff(a,s):(j.prod||j.say(e,"trample",{timeout:j.internal.timeout,listener:o}),document.getElementById(t).innerHTML=v.g(o.elem)),(u=y.stopNot(j.internal.queue,undefined,function(e,t){var n=j.internal.queue.shift();if(j.listeners[n[1]])return n}))?j.redraw.apply(null,u.concat(!0)):j.internal.redrawing=!1},j.applyDiff=function(a,u){var s=function(e,t,n){var r=c(t,"insert1",n);r?r.parentNode.insertBefore(e,r):c(t.slice(0,t.length-1),"insert2",n).appendChild(e)},c=function(n,r,i){var o=a;return y.go(n,function(e,t){if(o)return o=o.childNodes[e];throw j.prod||j.error(x,"redraw",{action:r,position:i,diffitem:u[i].slice(0,2).join(" "),id:id,where:n,k:t,innerHTML:a.innerHTML,expectedHTML:v.g(view,v.g(view)),oldElement:listener.elem,newElement:view,diff:y.obj(b.copy(u),function(e,t){return[t,e]})}),new Error("gotoB redraw error!")}),o},i=[],o=[],l={add:{tag:null,index:null},rem:{tag:null,index:null}};y.go(u,function(e,t){if(!e[1].match(/^<opaque/))if(e[1].match(/^>/)||(u[t][2]={el:c(i,"sequence",t),old:b.copy(i),New:b.copy(o)}),e[1].match(/^</)){u[t][2].active=u[t][2].el===document.activeElement;var n=e[1].match(/[^\s]+/g)[0],r=e[1].match(/<.+ {.*"opaque":true.*}/);"add"!==e[0]||r||(l.rem.tag===n?(u[t][2].match=l.rem.index,u[l.rem.index][2].match=t,l.rem.tag=l.rem.index=null):(l.add.tag=n,l.add.index=t)),"rem"!==e[0]||r||(l.add.tag===n?(u[t][2].match=l.add.index,u[l.add.index][2].match=t,l.add.tag=l.add.index=null):(l.rem.tag=n,l.rem.index=t)),"add"!==e[0]&&i.push(0),"rem"!==e[0]&&o.push(0)}else e[1].match(/^>/)?("add"!==e[0]&&(i.pop(),i[i.length-1]++),"rem"!==e[0]&&(o.pop(),o[o.length-1]++)):("add"!==e[0]&&i[i.length-1]++,"rem"!==e[0]&&o[o.length-1]++)});var f,d={},p=[],g=[],h=[],m=[];y.go(u,function(e,t){if(!e[1].match(/^>/)){if(e[1].match(/^<opaque/)){if("rem"===e[0])return;return y.stopNot(y.times(t,t-1,-1),undefined,function(e){if("rem"!==u[e][0])return u[e]})[2].el.innerHTML=e[1].slice(7)}if("<"!==e[1][0]&&"rem"!==e[0]&&1<e[2].New.length){var n=c(e[2].New.slice(0,-1));"TEXTAREA"===n.tagName&&m.push([n,e[1]])}if("keep"===e[0])if(e[1].match(/<.+ {.*"opaque":true.*}/)&&(e[2].el.innerHTML=""),e[2].el){if(e[1].match(/<option/))JSON.parse(e[1].match(/{.+/)||"{}").selected&&p.push(e[2].el);s(e[2].el.parentNode.removeChild(e[2].el),e[2].New,t),e[2].active&&"a"!==e[1].match(/[^<\s]+/g)[0]&&(f=e[2].el)}else s(document.createTextNode(e[1]),e[2].New,t);else if(e[1].match(/^</)){if("rem"===e[0]&&(e[2].match===undefined||e[2].match>t)&&(d[e[2].old]=e[2].el.parentNode.removeChild(e[2].el)),"add"===e[0]){var r;if(e[2].match!==undefined){var i=u[e[2].match];d[i[2].old]||(d[i[2].old]=i[2].el),r=i[2].el;var o=y.obj(r.attributes,function(e){if(e&&e.specified)return[e.name,e.value]}),a=JSON.parse(e[1].match(/{.+/)||"{}");y.go(y.fil(o,undefined,function(e,t){if("string"===w(e)&&(e={name:t}),a[e.name]===undefined)return e.name}),function(e){r.removeAttribute(e),-1<["value","checked","selected"].indexOf(e)&&(r[e]="value"===e&&""),"selected"===e&&g.push(r)}),y.go(a,function(e,t){r.setAttribute(t,e),-1<["value","checked","selected"].indexOf(t)&&(r[t]=e)}),r.attributes&&r.attributes.selected&&p.push(r),r.attributes&&r.attributes.checked&&h.push(r)}else r=document.createElement(e[1].match(/[^<\s]+/g)[0]),y.go(JSON.parse(e[1].match(/{.+/)||"{}"),function(e,t){!e&&""!==e&&0!==e||r.setAttribute(t,e)});s(r,e[2].New,t),e[2].el=r,i&&i[2].active&&"a"!==e[1].match(/[^<\s]+/g)[0]&&(f=r)}}else"add"===e[0]?(e[1]=e[1].replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#96;/g,"`"),s(document.createTextNode(e[1]),e[2].New,t)):e[2].el&&e[2].el.parentNode.removeChild(e[2].el);e[1].match(/<textarea/)&&"rem"!==e[0]&&m.push([e[2].el])}}),f&&(f.focus?f.focus():f.setActive(),f.blur(),f.focus?f.focus():f.setActive()),y.go(p,function(e){e.selected=!0}),y.go(g,function(e){e.selected=!1}),y.go(h,function(e){e.checked=!0});var t=y.fil(m,undefined,function(e){if(2===e.length)return e[0]});y.go(m,function(e){if(2===e.length)return e[0].value=e[1].replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#96;/g,"`");-1===t.indexOf(e[0])&&(e[0].value="")})},j.prediff=function(e,t){if(b.simple(e))return e===undefined||""===e?t?undefined:[]:t?(0===t.length&&t.push(""),t[t.length-1].match(/^(<|>)/)&&t.push(""),t[t.length-1]+=v.g(e)):[v.g(e)];if(t=t||[],-1<v.k.tags.indexOf(e[0])){e[1]&&e[1].id&&(e[1].id+"").match(/^в[0-9a-f]+$/g)&&(e=j.listeners[e[1].id].elem);var n="object"!==w(e[1])?undefined:y.obj(e[1],function(e,t){if(e||0===e)return[t,e]});t.push("<"+e[0]);var r=e[n?2:1];n&&(t[t.length-1]+=" "+JSON.stringify(n),n.opaque&&t.push("<opaque"+v.g(r,!0)));var i=t.length;if(n&&n.opaque||j.prediff(r,t),"table"===e[0]&&t[i]){if(t[i].match(/<thead/)){var o=0;y.stopNot(y.times(t.length-i,i),undefined,function(e){if(t[e].match(/</)&&o++,t[e].match(/>/)&&o--,0===o)return i=e+1})}t[i]&&null===t[i].match(/<tbody/)&&(t.splice(i,0,"<tbody"),t.push(">"))}t.push(">")}else y.go(e,function(e){j.prediff(e,t)});return t},j.diff=function(t,e){for(var n,r,i,o,a,u,s,c,l,f=[],d=0,p=b.time();d<t.length+e.length+1;){if(j.internal.timeout&&(new Date).getTime()-p>j.internal.timeout)return!1;for(n=f[f.length-1]||{1:[0,0]},r={},f.push(r),i=-d;i<2*d-d+1;){for(a=(o=i===-d||i!==d&&n[i-1][1]<n[i+1][1]?[0,n[i+1][1]]:[0,n[i-1][1]+1,!0])[1]-i;o[1]<t.length&&a<e.length&&t[o[1]]===e[a];)o[1]++,a++,o[0]++;if(!((r[i]=o)[1]<t.length||a<e.length)){for(u={x:o[1],y:a},s=[],c=d;-1<c;)a=(l=f[c][u.x-u.y])[1]-(u.x-u.y),l[0]&&y.go(y.times(l[0]),function(e){s.unshift(["keep",t[l[1]-e]])}),l[2]?s.unshift(["rem",t[l[1]-l[0]-1]]):s.unshift(["add",e[a-l[0]-1]]),u.x=l[1]-l[0]-(l[2]?1:0),u.y=a-l[0]-(l[2]?0:1),c--;return s.shift(),s}i+=2}d++}}}();