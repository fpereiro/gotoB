!function(){var d,e="object"==typeof exports;d=e?exports:window.dale={};var f=function(){return Object.prototype.toString.call(arguments).match("arguments")}(),p=function(e,t){var n=typeof e;return"function"===n?Object.prototype.toString.call(e).match(/regexp/i)?"regex":"function":"object"!==n&&"number"!==n?n:e instanceof Array?"array":"number"===n?isNaN(e)?"nan":isFinite(e)?e%1==0?"integer":"float":"infinity":null===e?"null":"array"===(n=Object.prototype.toString.call(e).replace("[object ","").replace("]","").toLowerCase())||"date"===n?n:"regexp"===n?"regex":t?!f&&"function"===n(e.callee)?"arguments":n:"object"};try{d.clog=console.log.bind(console)}catch(t){d.clog=function(){var e=d.go(arguments,function(e){return e===undefined?"undefined":e}).join(" ");window.console?window.console.log(e):alert(e)}}e=function(l){return function(e,t,n,r){var i,o,a,u,s;if("go"===l?(o=t,a=!0===n,u=[],i=0):"fil"===l?(o=n,a=!0===r,u=[],i=0):"obj"!==l?(o=n,a=!0===r):u="object"===p(t)?(o=n,a=!0===r,t):(o=t,a=!0===n,{}),"function"!==p(o))return d.clog(("go"===l||"obj"===l&&"object"!==p(t)?"Second":"Third")+" argument passed to dale."+l+" must be a function but instead is",o,"with type",p(o)),!1;if(e===undefined)return u;s="go"===l?function(e){u[i++]=e}:"fil"===l?function(e){e!==t&&(u[i++]=e)}:"obj"===l?function(e){if(e!==undefined)return"array"!==p(e)||2!==e.length?(d.clog("array"===p(e)?"fun passed to dale.obj must return undefined or an array of length 2 but instead returned an array of length "+e.length:"fun passed to dale.obj must return undefined or an array of length 2 but instead returned a value of type "+p(e)),!(u=!1)):void(u[e[0]]=e[1])}:function(e){return u=e,"stop"===l?e===t:e!==t};n=p(e);if("object"===n&&("[object Arguments]"!==Object.prototype.toString.call(e)&&(f||"function"!==p(e.callee))||(n="array",e=[].slice.call(e))),"array"===n)for(var c=0;c<e.length&&!s(o(e[c],parseInt(c)));c++);else if("object"===n){for(var c in e)if((a||!e.hasOwnProperty||e.hasOwnProperty(c))&&s(o(e[c],c)))break}else s(o(e,0));return u}};d.go=e("go"),d.fil=e("fil"),d.obj=e("obj"),d.stop=e("stop"),d.stopNot=e("stopNot"),d.keys=function(e,t){return d.go(e,function(e,t){return t},t)},d.times=function(e,t,n){if(0===e)return[];if("integer"!==p(e)||e<0)return d.clog("steps must be a positive integer or zero."),!1;if(t===undefined)t=1;else if("integer"!==p(t)&&"float"!==p(t))return d.clog("start must be an integer or float."),!1;if(n===undefined)n=1;else if("integer"!==p(n)&&"float"!==p(n))return d.clog("step must be an integer or float."),!1;for(var r=[t];r.length<e;)r.push(t+=n);return r},d.acc=function(e,t,n,r){var i=arguments.length===("boolean"===p(arguments[arguments.length-1])?4:3),o=i?t:undefined,a=i?n:t,u=i?r:n;if("function"!==p(a))return d.clog("fun must be a function but instead is of type",p(a)),!1;var s=!0;return d.go(e,function(e,t){return!i&&s?(s=!1,o=e):void(o=a(o,e))},u),o}}(),function(){var d,n="object"==typeof exports,f=n?require("dale"):window.dale;d=n?exports:window.teishi={},Array.prototype.indexOf||(Array.prototype.indexOf=function(n,r){var e=f.stopNot(this,undefined,function(e,t){if(!(r&&t<r))return n===e?t:void 0});return e===undefined?-1:e});var r=function(){return Object.prototype.toString.call(arguments).match("arguments")}();d.type=function(e,t){var n=typeof e;return"function"===n?Object.prototype.toString.call(e).match(/regexp/i)?"regex":"function":"object"!==n&&"number"!==n?n:e instanceof Array?"array":"number"===n?isNaN(e)?"nan":isFinite(e)?e%1==0?"integer":"float":"infinity":null===e?"null":"array"===(n=Object.prototype.toString.call(e).replace("[object ","").replace("]","").toLowerCase())||"date"===n?n:"regexp"===n?"regex":t?!r&&"function"===d.type(e.callee)?"arguments":n:"object"},d.str=function(){try{return JSON.stringify.apply(JSON.stringify,arguments)}catch(e){return!1}},d.parse=function(){try{return JSON.parse.apply(JSON.parse,arguments)}catch(e){return!1}},d.simple=function(e){e=d.type(e);return"array"!==e&&"object"!==e},d.complex=function(e){return!d.simple(e)},d.copy=function(r,i){if(d.simple(r))return r;var e=d.type(r,!0),o="array"===e||"arguments"===e?[]:{};return f.go(r,function(e,t){if(d.simple(e))return o[t]=e;var n=i?i.concat():[r];return-1<n.indexOf(e)?o[t]="[Circular]":(n.push(e),o[t]=d.copy(e,n))}),o},d.eq=function(e,n){return d.simple(e)&&d.simple(n)?e===n:d.type(e,!0)===d.type(n,!0)&&(d.str(f.keys(e).sort())===d.str(f.keys(n).sort())&&!1!==f.stop(e,!1,function(e,t){return d.eq(e,n[t])}))},d.last=function(e,t){return-1===["array","arguments"].indexOf(d.type(e,!0))?d.clog("First argument passed to teishi.last must be array or arguments but instead has type "+d.type(e,!0)):t!==undefined&&("integer"!==d.type(t)||t<1)?d.clog("Second argument passed to teishi.last must be either undefined or an integer larger than 0."):e[e.length-(t||1)]},d.time=function(e){return(arguments.length?new Date(e):new Date).getTime()};var i,l=function(){return n?"[0m":""},p=function(){return n?"[1m":""},g=function(){return n?"[37m":""},h=function(e){if(!n)return"";for(var t=i;i===t;)t=Math.round(5*Math.random()+1);return"["+(e?"4":"3")+(i=t)+"m"};d.clog=function(){var s=p();!function c(e,i){var o=d.type(e),i=i||0,a=!0;"object"===o&&"[object Arguments]"===Object.prototype.toString.call(e)&&(o="array");var u=i<2?"":"\n"+f.go(f.times(i-1),function(e){return"   "}).join("");0<i&&(s+="array"===o?g()+"[":g()+"{"),f.go(e,function(e,t){var n,r=d.type(e);if(0===i&&0===t&&("string"===r||"integer"===r))return s+=h(!(a=!1))+e+":"+l()+p();a||(s+=g()+(0===i?" ":", ")),a=!1,"string"===r&&0<i&&(e="'"+e+"'"),"function"===r&&(150<(e=null!==(n=(e+="").match(/\s+(?=}$)/))?e.replace(new RegExp(n[0],"g"),"\n"):e).length&&(e=e.slice(0,150)+"...\n"),1<i&&(e=e.replace(/\n/g,"array"===o?u:"\n"+(t+": ").replace(/./g," ")+u.slice(1)))),s+=h(),"object"===o&&(s+=u+(t.match(/^[0-9a-zA-Z_]+$/)?t:"'"+t+"'")+": "),"array"===r||"object"===r?c(e,i+1):s+="object"===o?e:u+e}),0<i&&("array"===o&&(s+=(1<i?"\n":"")+u.slice(4)+g()+"]"),"object"===o&&(s+=(1<i?"\n":"")+u.slice(4)+g()+"}"))}(d.copy(arguments));var e=new Date;return f.clog("("+e[e.toISOString?"toISOString":"toString"]()+")",s+l()),!1},d.lno=function(){n=!1},d.makeTest=function(c,l){if("function"!==d.type(c))return d.clog("teishi.makeTest","fun passed to teishi.makeTest should be a function but instead is",c,"with type",d.type(c));if("string"===d.type(l)&&(l=[l]),"array"!==d.type(l))return d.clog("teishi.makeTest","clauses argument passed to teishi.makeTest should be an array but instead is",l,"with type",d.type(l));if("string"!==d.type(l[0]))return d.clog("teishi.makeTest","shouldClause passed to teishi.makeTest should be a string but instead is",l[0],"with type",d.type(l[0]));if(l[1]!==undefined&&("array"!==d.type(l[1])&&(l[1]=[l[1]]),!0!==f.stopNot(l[1],!0,function(e){var t=d.type(e);return"string"===t||"function"===t||d.clog("teishi.makeTest","Each finalClause passed to teishi.makeTest should be a string or a function but instead is",e,"with type",t)})))return;return function(e,t,n,r,i,o){var a=c(n,r);if(!0===a)return!0;if("array"===d.type(a))return a;var u=[],s=0;return i!==undefined&&(u[s++]="each of the"),t[0]&&(u[s++]=t[0]),e&&(u[s++]="passed to",u[s++]=e),u[s++]=l[0],o!==undefined&&(u[s++]="one of"),u[s++]=o!==undefined?o:r,t[1]&&(u[s++]="("+t[1]+")"),u[s++]=i!==undefined?"but one of":"but instead",i!==undefined&&(u[s++]=i),u[s++]="is",u[s++]=n,f.go(l[1],function(e){u[s++]="function"!=typeof e?e:e(n,r)}),u}},d.test={type:d.makeTest(function(e,t){return d.type(e)===t},["should have as type",["with type",d.type]]),equal:d.makeTest(d.eq,"should be equal to"),notEqual:d.makeTest(function(e,t){return!d.eq(e,t)},"should not be equal to"),range:d.makeTest(function(n,e){return"object"!==d.type(e,!0)?["Range options object must be an object but instead is",e,"with type",d.type(e,!0)]:"{}"===d.str(e)||f.stopNot(e,!0,function(e,t){return"min"!==t&&"max"!==t&&"less"!==t&&"more"!==t?['Range options must be one of "min", "max", "less" and "more", but instead is',t]:"min"===t?e<=n:"max"===t?n<=e:"less"===t?n<e:e<n})},"should be in range"),match:d.makeTest(function(e,t){return"string"!==d.type(e)?["Invalid comparison string passed to teishi.test.match. Comparison string must be of type string but instead is",e,"with type",d.type(e)]:"regex"!==d.type(t)?["Invalid regex passed to teishi.test.match. Regex must be of type regex but instead is",t,"with type",d.type(t)]:null!==e.match(t)},"should match")},d.validateRule=function(r){var e=d.type(r);if("function"===e||"boolean"===e)return!0;if("array"!==e)return["each teishi rule must be an array or boolean or function but instead is",r,"with type",e];var i,o,e=d.type(r[0]);return"string"!==e&&("array"!==e||2!==r[0].length||"string"!==d.type(r[0][0])||"string"!==d.type(r[0][1]))||(3===r.length||(r.length<3||5<r.length?["Each teishi simple rule must be an array of length between 3 and 5, but instead is",r,"and has length",r.length]:f.stopNot(r,!0,function(e,t){if(t<3)return!0;var n=d.type(e);if("string"===n){if("oneOf"!==e&&"each"!==e&&"eachOf"!==e)return["Invalid multi parameter",e,". Valid multi parameters are",["oneOf","each","eachOf"]];if(o)return["You can pass only one multi parameter to a teishi simple rule but instead you passed two:",r[3],"and",r[4]];o=e}else{if("function"!==n)return["Elements #4 and #5 of a teishi simple rule must be either a string or a function, but element","#"+(t+1),"is",e,"and has type",n];if(i)return["You can pass only one test function to a teishi simple rule but instead you passed two:",r[3],"and",r[4]];i=e}return!0})))};var m=function(e,t){return t===undefined?d.clog.apply(d.clog,["teishi.v"].concat(e)):(e=f.go(e,function(e){return d.complex(e)?d.str(e):e+""}).join(" "),!0===t?e:(t(e),!1))};d.v=function(e,t,n,r){var i,o,a,u;if(!(u="string"===d.type(e)?(i=e,o=t,a=n,r):(i="",o=e,a=t,n))){if(a!==undefined&&!0!==a&&"function"!==d.type(a))return d.clog("teishi.v","Invalid apres argument. Must be either undefined, true, or a function.");var s=d.validateRule(o);if(!0!==s)return m(s,a)}t=d.type(o);if("boolean"===t)return o;if("function"===t)return d.v(i,o(),a,u);if(0===o.length)return!0;n=d.type(o[0]);if("boolean"===n&&2===o.length&&"array"===d.type(o[1]))return!1===o[0]||d.v(i,o[1],a,u);if("string"!==n&&("array"!==n||2!==o[0].length||"string"!==d.type(o[0][0])||"string"!==d.type(o[0][1])))return f.stopNot(o,!0,function(e){return d.v(i,e,a,u)});var s=d.type(o[3]),t=d.type(o[4]),c="function"===s?o[3]:"function"===t?o[4]:d.test.type,s="string"===s?o[3]:"string"===t?o[4]:undefined,l="array"===n?o[0]:[o[0]],t=d.type(o[1],!0),n=d.type(o[2],!0);return("each"===s||"eachOf"===s)&&("array"===t&&0===o[1].length||"object"===t&&0===f.keys(o[1]).length||o[1]===undefined)||(!0===(s="oneOf"!==s&&"eachOf"!==s||!("array"===n&&0===o[2].length||"object"===n&&0===f.keys(o[2]).length||o[2]===undefined)?s===undefined?c(i,l,o[1],o[2]):"each"===s?f.stopNot(o[1],!0,function(e){return c(i,l,e,o[2],o[1])}):"oneOf"===s?f.stop(o[2],!0,function(e){return c(i,l,o[1],e,undefined,o[2])}):f.stopNot(o[1],!0,function(t){return f.stop(o[2],!0,function(e){return c(i,l,t,e,o[1],o[2])})}):["To field of teishi rule is",o.to,"but multi attribute",s,"requires it to be non-empty, at teishi step",o])||m(s,a))},d.stop=function(){return!0!==d.v.apply(d.v,arguments)}}(),function(){var u,e="object"==typeof exports,s=e?require("dale"):window.dale,o=e?require("teishi"):window.teishi;u=e?exports:window.lith={};var c=o.type,l=o.clog;u.k={lithbagElements:["string","integer","float","array","undefined"],tags:["!DOCTYPE HTML","LITERAL","a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],voidTags:["!DOCTYPE HTML","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]},u.entityify=function(e,t){return!(!t&&o.stop("lith.entityify",["Entityified string",e,"string"]))&&e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;")},u.v=function(t,e){var n=c(t);if("array"===n&&-1<u.k.tags.indexOf(t[0])){var r="object"===c(t[1])?t[1]:undefined,i=t[r?2:1];return!0===(i=o.v([["lith length",t.length,{min:1,max:3},o.test.range],[r===undefined,["length of lith without attributes",t.length,{max:2},o.test.range]],[["lith attribute keys","start with an ASCII letter, underscore or colon, and be followed by letters, digits, underscores, colons, periods, dashes, extended ASCII characters, or any non-ASCII characters."],s.keys(r),/^[a-zA-Z_:][a-zA-Z_:0-9.\-\u0080-\uffff]*$/,"each",o.test.match],["lith attribute values",r,["string","integer","float","undefined","null","boolean"],"eachOf"],"LITERAL"===t[0]?["lith LITERAL contents",i,"string"]:["lith contents",i,u.k.lithbagElements,"oneOf"]],!!e||function(e){l("lith.v - Invalid lith",{error:e,"original input":t})}))?"Lith":!!e&&{error:i,"original input":t}}return!0===(i=o.v([["lithbag",n,u.k.lithbagElements,"oneOf",o.test.equal],["array"===n,["lithbag elements",t,u.k.lithbagElements,"eachOf"]]],!!e||function(e){l("lith.v - Invalid lithbag",{error:e,"original input":t})}))?"Lithbag":!!e&&{error:i,"original input":t}},u.g=function(e,t){if(t||u.prod)return!0!==(t||u.prod)?l("lith.g","prod or lith.prod must be true or undefined."):"array"===c(e)&&-1<u.k.tags.indexOf(e[0])?u.generateLith(e,!0):u.generateLithbag(e,!1,!0);t=u.v(e);return!!t&&u["generate"+t](e)},u.generateLithbag=function(e,t,n){var r="";return!1!==s.stop(e,!1,function(e){if(e!==undefined){c(e);if("array"!==c(e))return r+=t?e:u.entityify(e+"",n);e=u.g(e,n);if(!1===e)return!1;r+=e}})&&r},u.generateLith=function(e,n){var t="object"===c(e[1])?e[1]:undefined,r=e[t?2:1];if("LITERAL"===e[0])return r;var i="<"+e[0];if(s.go(t,function(e,t){!e&&0!==e||(i+=" "+u.entityify(t+"",n)+'="'+u.entityify(e+"",n)+'"')}),i+=">","array"===c(r)){t=("style"===e[0]?u.css:u).g(r,n);if(!1===t)return!1;i+=t}else i+=u.generateLithbag(r,"style"===e[0]||"script"===e[0],n);return-1===u.k.voidTags.indexOf(e[0])&&(i+="</"+e[0]+">"),i},u.css={},u.css.v=function(t,e){var n=o.v(["litc or litcbag",t,"array"],!!e||function(e){l("lith.css.v - Invalid litc or litcbag",{error:e,"original input":t})});if(!0!==n)return!!e&&{error:n,"original input":t};if(0===t.length||"array"===c(t[0]))return!0;var r="object"===c(t[1])?t[1]:undefined,i=t[r?2:1];return!0===(n=o.v([["litc length",t.length,{min:1,max:3},o.test.range],[r===undefined,["length of litc without attributes",t.length,{max:2},o.test.range]],["litc selector",t[0],"string"],u.css.vAttributes(r),"LITERAL"===t[0]?["litc LITERAL contents",i,"string"]:["litc contents",i,["undefined","array"],"oneOf"]],!!e||function(e){l("lith.css.v - Invalid litc",{error:e,"original input":t})}))?n:!!e&&{error:n,"original input":t}},u.css.vAttributes=function(e){return o.v([["litc attribute values",e,["string","integer","float","object","undefined","null","boolean"],"eachOf"]])},u.css.g=function(e,n,r){if(n||u.prod){if(!0!==(n||u.prod))return l("lith.css.g","prod or lith.prod must be true or undefined.");n=!0}if(!n&&!1===u.css.v(e))return!1;if(0===e.length)return"";if("LITERAL"===e[0])return e[1];var i="";if("array"===c(e[0]))return!1!==s.stop(e,!1,function(e,t){e=u.css.g(e,n,r);if(!1===e)return!1;i+=e})&&i;r===undefined&&(r="");var t="object"===c(e[1])?e[1]:undefined,o=e[t?2:1];r=s.go(r.split(/,\s*/),function(t){return s.go(e[0].split(/,\s*/),function(e){return e.match(/&/)?e.replace("&",t):t+(0===t.length?"":" ")+e}).join(", ")}).join(", "),i+=r+"{";var a=function(e){return!1!==u.css.vAttributes(e)&&s.stop(e,!1,function(t,e){if(t||0===t){var n=c(t);if("object"===n)return a(t);"integer"===n&&(t<0||1<t)&&(t+="px"),"float"!==n&&1!==t||(t=100*t+"%"),s.go(e.split(/,\s*/),function(e){i+=e+":"+t+";"})}})};if(!1===a(t))return!1;if(i===r+"{"?i="":i+="}",o){o=u.css.g(o,n,r);if(!1===o)return!1;i+=o}return i},u.css.media=function(e,t){return!o.stop(["selector",e,"string"])&&[["LITERAL","@media "+e+" {"],t,["LITERAL","}"]]},u.css.style=function(e,t){t=u.css.g(["",e],t);return!1===t?t:t.slice(1,-1)}}(),function(){var e="object"==typeof exports,u=e?require("dale"):window.dale,s=e?require("teishi"):window.teishi,c=s.type,t=s.clog,n=function(e){if(!s.stop([["store",e,["array","object","undefined"],"oneOf"]])){var a={responders:{},store:e||{},log:[],error:t,count:{e:1,r:1},call:function(){var e=arguments[(o="object"===c(arguments[0])?arguments[0]:undefined)?1:0],t=arguments[o?2:1];if(s.simple(t)&&(t=[t]),!a.prod&&s.stop("r.call",[["context",o,["object","undefined"],"oneOf"],[o!==undefined,[function(){return["x.from",o.from,["string","undefined"],"oneOf"]}]],["verb",e,"string"]],function(e){o?a.error(o,"r.call",e):a.error("r.call",e)}))return!1;if(!a.prod&&!a.isPath(t))return o?a.error(o,"r.call","Invalid path. Arguments:",{verb:e,path:t}):a.error("r.call","Invalid path. Arguments:",{verb:e,path:t});var n=arguments,r=arguments.length===(o?3:2)?undefined:u.go(u.times(arguments.length-(o?3:2),o?3:2),function(e){return n[e]}),i=o?o.responder?o.responder.id+"/"+o.from:o.from:undefined,o={from:"E"+a.count.e++,verb:e,path:t,args:r};return a.addLog({t:s.time(),from:i,id:o.from,verb:e,path:t,args:s.copy(r)}),a.mill(r===undefined?[o]:[o].concat(r)),o.from},respond:function(){var e,t=arguments[arguments.length-1];if(arguments.length<2)return a.error("r.respond","Too few arguments passed to r.respond");if(2===arguments.length?e=arguments[0]:((e=3===arguments.length?{}:arguments[2]).verb=arguments[0],e.path=arguments[1]),s.simple(e.path)&&(e.path=[e.path]),!a.prod&&s.stop("r.respond",[["options",e,"object"],["keys of options",u.keys(e),["verb","path","id","parent","priority","burn","match"],"eachOf",s.test.equal],function(){return[["options.verb",e.verb,["string","regex"],"oneOf"],["options.id",e.id,["string","integer","undefined"],"oneOf"],["options.parent",e.parent,["string","integer","undefined"],"oneOf"],["options.priority",e.priority,["undefined","integer"],"oneOf"],["options.burn",e.burn,["undefined","boolean"],"oneOf"],["options.match",e.match,["undefined","function"],"oneOf"]]},["responder function",t,"function"]],function(e){a.error("r.respond",e)}))return!1;if(!a.prod&&!a.isPath(e.path,!0))return a.error("r.respond","Invalid path. Options:",e);if(e.id!==undefined){if(e.id+="",!a.prod&&e.id.match(/^[R|E]\d+$/))return a.error("r.respond","If you pass an id for a responder, it cannot be an `R` or an `E` followed by digits, since that is the form that recalc gives to auto-generated ids.");if(!a.prod&&a.responders[e.id])return a.error("r.respond","A responder with id",e.id,"already exists.")}else e.id="R"+a.count.r;return e.rfun=t,e.index=a.count.r++,(a.responders[e.id]=e).id},forget:function(n,r){if(!a.prod&&r!==undefined&&"function"!==c(r))return a.error("r.forget","Second argument to r.forget must be a function or undefined. Id is:",n);if(!a.prod&&!a.responders[n])return a.error("r.forget","responder",n,"does not exist.");var e=a.responders[n];delete a.responders[n],r&&r(e),u.go(a.responders,function(e,t){e.parent===n&&a.forget(t,r)})},isPath:function(e,t){return s.v([["path",e,["array","integer","string"].concat(t?"regex":[]),"oneOf"],["path",e,["integer","string"].concat(t?"regex":[]),"eachOf"]],function(){})},compare:function(e,t){return"*"===e||"*"===t||("regex"===c(t)?null!==(e+"").match(t):e===t)},addLog:function(e){a.log.push(e)},mill:function(n){var r=function(e){if(0!==e.length){n[0].cb=function(){r(e)};var t=e.shift();if(n[0].responder=t,!a.responders[t.id])return r(e);a.addLog({t:s.time(),from:n[0].from,id:t.id,verb:t.verb,path:t.path,args:n.slice(1).length?s.copy(n.slice(1)):undefined}),t.burn&&a.forget(t.id),"function"!==c(t.rfun.apply(null,n))&&r(e)}};r(a.sort(a.match(n[0].verb,n[0].path,n.slice(1),a.responders)))},match:function(e,r,t,n){var i=[];return u.go(n,function(n){if(!n.disabled)return n.match?!0===n.match({verb:e,path:r,args:t},n)?i.push(n):undefined:a.compare(e,n.verb)&&r.length===n.path.length?0===r.length&&0===n.path.length?i.push(n):void(u.stop(r,!1,function(e,t){return a.compare(r[t],n.path[t])})&&i.push(n)):void 0}),i},sort:function(e){return e.sort(function(e,t){var n=(t.priority||0)-(e.priority||0);return 0!=n?n:e.index-t.index})}};return a}};e?module.exports=n:window.R=n}(),function(){if("object"==typeof exports)return console.log("cocholate only works in a browser!");var u=window.dale,s=window.teishi,c=s.type,l=s.clog;document.createElement("_").insertAdjacentHTML||(HTMLElement.prototype.insertAdjacentHTML=function(e,t){var n=document.createElement("div");for(n.innerHTML=t;n.firstChild;)"beforeBegin"===e?this.parentNode.insertBefore(n.firstChild,this):"afterBegin"===e?this.insertBefore(n.firstChild,this.firstChild):"beforeEnd"===e?this.appendChild(n.firstChild):this.parentNode.insertBefore(n.firstChild,this.nextElementSibling)});var d=window.c=function(e,t){if(s.stop("c",["fun",t,["function","undefined"],"oneOf"]))return!1;var n,r=e&&e.nodeName,i=r?[e]:d.find(e);return!1!==i&&(t&&(n=u.go(arguments,function(e){return e}).slice(2),i=u.go(i,function(e){return t.apply(undefined,[e].concat(n))})),r||"body"===e||"string"===c(e)&&e.match(/^[a-z0-9]*#[^\s\[>,:]+$/)?i[0]:i)};d.nodeListToArray=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},d.setop=function(e,t,n){if("and"===e)return u.fil(t,undefined,function(e){return-1<n.indexOf(e)?e:undefined});var r=t.slice();return"or"===e?u.go(n,function(e){-1===r.indexOf(n)&&r.push(e)}):(0===r.length&&(r=d.nodeListToArray(document.getElementsByTagName("*"))),u.go(n,function(e){e=r.indexOf(e);-1<e&&r.splice(e,1)})),r},d.find=function(t){var e=c(t);if(s.stop("cocholate",[["selector",t,["array","string","object"],"oneOf"],function(){return[["array"===e,["first element of array selector",t[0],[":and",":or",":not"],"oneOf",s.test.equal]],["object"===e,[["selector keys",u.keys(t),["selector","from"],"eachOf",s.test.equal],["selector.selector",t.selector,["array","string"],"oneOf"],function(){return!("object"!==c(t.from)||document.querySelectorAll&&!t.from.querySelectorAll)||l("teishi.v","selector.from passed to cocholate must be a DOM element.")}]]]}]))return!1;if("array"!==e){if(document.querySelectorAll&&"string"===e)return d.nodeListToArray(document.querySelectorAll(t));if(document.querySelectorAll&&"object"===e)return d.nodeListToArray(t.from.querySelectorAll(t.selector));var n=t.from||document;if("*"!==(t="string"===e?t:t.selector)&&!t.match(/^[a-z0-9]*(#|\.)?[^,>\[\]]+$/i))return l("The selector "+t+" is not supported in IE <= 7 or Firefox <= 3.");var r=t.match("#")?"id":t.match(/\./)?"class":undefined,i=2!==(t=t.split(/#|\./)).length&&r?undefined:t[0].toUpperCase();return u.fil(d.nodeListToArray(n.getElementsByTagName(i||"*")),undefined,function(e){if(!("class"===r&&-1===(e.className||"").split(/\s/).indexOf(s.last(t))||"id"===r&&e.id!==s.last(t)))return e})}var o=t.shift(),a=[];return u.stop(t,!1,function(e,t){e=d.find(e);if(!1===e)return a=!1;a=0===t&&":not"!==o?e:d.setop(o.replace(":",""),a,e)}),a},d.empty=function(e){d(e,function(e){e.innerHTML=""})},d.fill=function(e,t){if(s.stop("c.fill",["html",t,"string"]))return!1;d(e,function(e){e.innerHTML=t})},d.place=function(e,t,n){if(s.stop("c.place",[["where",t,["beforeBegin","afterBegin","beforeEnd","afterEnd"],"oneOf",s.test.equal],["html",n,"string"]]))return!1;d(e,function(e){e.insertAdjacentHTML(t,n)})},d.get=function(e,n,r){if(s.stop("c.get",["attributes",n,["string","array","undefined"],"oneOf"]))return!1;var i=[null,"",!1,0,"false"];return d(e,function(t){return n!==undefined?u.obj(n,function(e){return r?[e,t.style[e]||null]:[e,t.getAttribute(e)]}):r?u.obj(t.style.length?u.times(t.style.length,0):u.keys(t.style),function(e){return t.style.length?[t.style[e],t.style[t.style[e]]]:-1===i.indexOf(t.style[e])?[e,t.style[e]]:void 0}):u.obj(t.attributes,t["class"]||t.className?{"class":t["class"]||t.className}:{},function(e,t){if(e&&e.nodeName&&-1===i.indexOf(e.nodeValue))return[e.nodeName,e.nodeValue]})})},d.set=function(e,t,r,i){if(s.stop("c.set",[["attributes",t,"object"],[["attribute keys","start with an ASCII letter, underscore or colon, and be followed by letters, digits, underscores, colons, periods, dashes, extended ASCII characters, or any non-ASCII characters."],u.keys(t),/^[a-zA-Z_:][a-zA-Z_:0-9.\-\u0080-\uffff]*$/,"each",s.test.match],["attribute values",t,["integer","float","string","null"],"eachOf"]]))return!1;d(e,function(n){u.go(t,function(e,t){r?n.style[t]=null===e?"":e:null===e?n.removeAttribute(t):n.setAttribute(t,e)}),i||d.fire(n,"change")})},d.fire=function(e,r){if(s.stop("c.fire",["event type",r,"string"]))return!1;d(e,function(e){var t;try{t=new Event(r)}catch(n){t=document.createEvent?document.createEvent("Event"):document.createEventObject(),document.createEvent&&t.initEvent(r,!1,!1)}if(e.dispatchEvent)return e.dispatchEvent(t);if(!e.fireEvent)return l("c.fire error","Unfortunately, this browser supports neither EventTarget.dispatchEvent nor element.fireEvent.");try{e.fireEvent("on"+r,t)}catch(n){e["on"+r]&&e["on"+r]()}})},d.ready=function(e){if(window.addEventListener)return window.addEventListener("load",e,!1);if(window.attachEvent)return window.attachEvent("onload",e);var t=setInterval(function(){"complete"===document.readyState&&(e()||clearInterval(t))},10)},d.cookie=function(e){return!1===e?u.go(document.cookie.split(/;\s*/),function(e){return document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()),e}):u.obj((e||document.cookie).split(/;\s*/),function(e){if(""!==e)return[(e=e.split("="))[0],e.slice(1).join("=")]})},d.ajax=function(e,t,n,r,i){if(r=r||"",i=i||function(){},s.stop("c.ajax",[["method",e=e||"GET","string"],["path",t,"string"],["headers",n=n||{},"object"],["callback",i,"function"]]))return!1;var o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return o.open(e.toUpperCase(),t,!0),s.complex(r)&&"formdata"!==c(r,!0)&&(n["content-type"]=n["content-type"]||"application/json",r=s.str(r)),u.go(n,function(e,t){o.setRequestHeader(t,e)}),o.onreadystatechange=function(){if(4===o.readyState){if(200!==o.status&&304!==o.status)return i(o);var n,e={xhr:o,headers:u.obj(o.getAllResponseHeaders().split(/\r?\n/),function(e){if(""!==e){var t=e.match(/^[^:]+/)[0],e=e.replace(t,"").replace(/:\s+/,"");return t.match(/^content-type/i)&&e.match(/application\/json/i)&&(n=!0),[t,e]}})};e.body=n?s.parse(o.responseText):o.responseText,i(null,e)}},o.send(r),{headers:n,body:r,xhr:o}},d.loadScript=function(e,r){return r=r||function(){},d.ajax("get",e,{},"",function(e,t){if(e)return r(e);var n=document.createElement("script");try{n.appendChild(document.createTextNode(t.body))}catch(e){n.text=t.body}document.body.appendChild(n),r(null,t)})},d.test=function(r){if(s.stop("c.test",[["tests",r,"array"],["tests",r,"array","each"],u.go(r,function(e,t){return[["test length",e.length,{min:2,max:3},s.test.range],["test #"+(t+1)+" tag",e[0],"string"],2===e.length?["test #"+(t+1)+" check",e[1],"function"]:[["test #"+(t+1)+" action",e[1],"function"],["test #"+(t+1)+" check",e[2],"function"]]]})]))return!1;var i=s.time(),o=function(e){var t=r[e];if(!t)return l("c.test","All tests finished successfully ("+(s.time()-i)+" ms)");var n=function(){if(!1===t[2===t.length?1:2]())throw new Error("c.test: Test failed: "+t[0]);o(e+1)};if(l("c.test","Running test:",t[0]),2===t.length)return n();t[1](function(e){if(e===undefined)return n();if("integer"!==c(e)||e<0)throw new Error("c.test: wait parameter must zero or a positive integer but instead is "+e);setTimeout(n,e)})!==undefined&&n()};o(0)}}(),function(){if("object"==typeof exports)return console.log("gotoв only works in a browser!");var v=window.dale,s=window.teishi,d=window.lith,c=window.R(),o=window.c,l=s.type,f=Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},w=window.B={v:"2.1.0",B:"в",t:f(),r:c,responders:c.responders,store:c.store,log:c.log,call:c.call,respond:c.respond,forget:c.forget};c.error=w.error=function(){var e="object"===l(arguments[0])?arguments[0]:undefined,t=v.go(arguments,function(e){return e}).slice(e?1:0);return w.call.apply(null,[e||{},"error"].concat(t)),!1},w.respond({id:"error",verb:"error",path:[],match:function(e){return"error"===e.verb}},function(){document.body.innerHTML+=d.g(["div",{id:"eventlog-snackbar",style:d.css.style({position:"fixed","font-weight":"bold",opacity:"0.8",top:0,left:.1,width:.8,padding:10,color:"white","background-color":"black","z-index":"10001","text-align":"center"})},"There was an error."],!0),setTimeout(function(){o("#eventlog-snackbar")&&document.body.removeChild(o("#eventlog-snackbar"))},3e3),w.eventlog()}),w.eventlog=function(){o("#eventlog")&&document.body.removeChild(o("#eventlog"));var r={},i=["#fe6f6c","#465775","#e086c3","#8332ac","#462749","#044389","#59c9a6","#ffad05","#7cafc4","#5b6c5d"];document.body.innerHTML+=d.g(["table",{id:"eventlog"},[["style",["#eventlog",{"border-collapse":"collapse","font-family":"monospace","font-size":18,position:"absolute","right, top":4,width:Math.min(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,800),"z-index":"10000",border:"solid 4px #4488DD"},["th, td",{"padding-left, padding-right":10,"border-bottom, border-right":"solid 1px black"}]]],["tr",v.go(["#","ms","type","id","from","verb","path","args"],function(e){return["th",{style:d.css.style({"background-color":"#efefef"})},e]})],v.go(w.log,function(e,t){var n="E"!==e.id[0]&&e.from&&e.from.match(/^E\d+$/)?e.id+"/"+e.from:undefined;return r[n||e.id]=t,["tr",{style:d.css.style({"background-color":{0:"#fcfcfc",1:"#efefef"}[t%2]})},v.go(["#"+(t+1),e.t-w.t,e.id.match(/^E\d+$/)?"event":"responder",e.id,e.from,e.verb,e.path.join(":"),500<(e=v.go(e.args,w.str).join(", ")).length?e.slice(0,500)+"... ["+(e.length-500)+" more characters]":e],function(e,t){return 1===t?["td",e/1e3+(e%1e3?"":".0")+(e%100?"":"0")+(e%10?"":"0")+"s"]:3!==t&&4!==t?["td",e]:["td",{onclick:e===undefined?"":'var row = c ({from: c ("#eventlog"), selector: "tr"}) ['+((r[e]===undefined?r[n]:r[e])+1)+']; row.scrollIntoView (); row.style.background = "#8e8e8e"; setTimeout (function () {row.style.background = "#bebebe"}, 500); setTimeout (function () {row.style.background = "white"}, 1000);',style:d.css.style({cursor:"pointer","font-weight":"bold",color:i[parseInt(r[e])%i.length]})},e===undefined?"":e]})]})]],!0),o("tr")[w.log.length].scrollIntoView()},w.get=function(){var n="array"===l(arguments[0])?arguments[0]:v.go(arguments,function(e){return e});if(!w.prod&&!c.isPath(n))return w.error("B.get","Invalid path:",n)||undefined;var r=w.store;return!1===v.stop(n,!1,function(e,t){return!(t<n.length-1&&s.simple(r[e]))&&void(r=r[e])})?undefined:r},w.set=function(){var e="object"===l(arguments[0])?arguments[0]:undefined,n=arguments[e?1:0],r=arguments[e?2:1];if(!w.prod&&!c.isPath(n))return w.error(e||{},"B.set","Invalid path:",n);if(0===(n="array"!==l(n)?[n]:n).length)return!w.prod&&s.simple(r)?w.error(e||{},"B.set","Cannot set B.store to something that is not an array or object."):(w.store=r,!0);e="string"===l(n[0])?"object":"array";l(w.store)!==e&&(w.store="object"==e?{}:[]);var i=w.store;return v.go(n,function(e,t){if(t===n.length-1)return i[e]=r;t="string"===l(n[t+1])?"object":"array";l(i[e])!==t&&(i[e]="object"==t?{}:[]),i=i[e]}),!0},w.add=function(){var n="object"===l(arguments[0])?arguments[0]:undefined,e=arguments[n?1:0];if(!w.prod&&!c.isPath(e))return w.error(n||{},"B.add","Invalid path:",e);w.get(e)===undefined&&w.set(e,[]);var r=w.get(e);return w.prod||"array"===l(r)?(v.go(arguments,function(e,t){(n?1:0)<t&&r.push(e)}),!0):w.error(n||{},"B.add","Cannot add to something that is not an array. Path:",e)},w.rem=function(){var t="object"===l(arguments[0])?arguments[0]:undefined,n=arguments[t?1:0];if(!w.prod&&!c.isPath(n))return w.error(t||{},"B.rem","Invalid path:",n);var r=w.get(n),e=l(r),i="array"===l(arguments[t?2:1])?arguments[t?2:1]:v.go(arguments,function(e){return e}).slice(t?2:1);return!(!w.prod&&s.stop("B.rem",[["type of target",e,["array","object","undefined"],"oneOf",s.test.equal],"array"===e?["keys of array target",i,"integer","each"]:[],"object"===e?["keys of object target",i,"string","each"]:[]],function(e){w.error(t||{},"B.rem",e,"Path:",n)}))&&("object"===e&&v.go(i,function(e){delete r[e]}),"array"===e&&(i=i.slice().sort(function(e,t){return t-e}),v.go(i,function(e){r.splice(e,1)})),!0)},w.mrespond=function(e){v.go(e,function(e){w.respond.apply(null,e)})},v.go(["add","rem","set"],function(n){w.respond({id:n,verb:n,path:[],match:function(e,t){return c.compare(e.verb,t.verb)}},function(e){var t="set"===n?w.get(e.path):s.copy(w.get(e.path));!1!==w[e.verb].apply(null,[e,e.path].concat(v.go(arguments,function(e){return e}).slice(1)))&&(s.eq(t,w.get(e.path))||w.call(e,"change",e.path,w.get(e.path),t))})}),w.changeResponder=function(t,n){return!!c.compare(t.verb,n.verb)&&(0===t.path.length||0===n.path.length||v.stop(v.times(Math.min(t.path.length,n.path.length),0),!1,function(e){return c.compare(t.path[e],n.path[e])}))},w.str=function(e){var t=l(e);return"array"!==t&&"object"!==t?"string"===t?s.str(e):e+"":"array"===t?"["+v.go(e,w.str).join(", ")+"]":"{"+v.go(e,function(e,t){return s.str(t)+": "+w.str(e)}).join(", ")+"}"},w.evh=function(e){return v.obj(o.get(e),function(e,t){if(!t.match(/^on/))return[t,e]})},w.ev=function(){var t;if(t="array"===l(arguments[0])?arguments:0===arguments.length?[]:[v.go(arguments,function(e){return e})],!w.prod&&s.stop("B.ev",v.go(t,function(e){return[["ev",e,"array"],function(){return[["ev.verb",e[0],"string"],function(){return!!c.isPath(e[1])||w.error("B.ev","Invalid path:",e[1],"Events:",t)}]}]}),function(e){w.error("B.ev",e,"Events:",t)}))return!1;var n='var id = B.call ("ev", event ? event.type : "undefined event", B.evh (this));';return v.go(t,function(e){var t=w.internal.oldFF?'this.value || (this.attributes.value ? this.attributes.value.nodeValue : "")':"this.value";n+=' B.call ({"from": id}, '+v.go(2===e.length?e.concat({raw:t}):e,function(e,t){return 1<t&&"object"===l(e)&&"string"===l(e.raw)?e.raw:w.str(e)}).join(", ")+");"}),n},w.mount=function(e,t){if(!w.prod&&"string"!==l(e)||!e.match(/^(body|[a-z0-9]*#[^\s\[>,:]+)$/))return w.error("B.mount","Target must be either 'body' or an id selector, but instead is "+e);var n="body"===e?document.body:document.getElementById(e.replace(/.*#/g,""));if(!w.prod){if(!n)return w.error("B.mount","Target not found:",e);if("function"!==l(t))return w.error("B.mount","fun must be a function but instead is",t)}n=t();if(!w.prod){t=w.validateLith(n);if("Lith"!==t&&"Lithbag"!==t)return w.error("B.mount","function returned invalid lith or lithbag",t)}o.place(e,"beforeEnd",d.g(n,!0))},w.unmount=function(e){if(!w.prod&&"string"!==l(e)||!e.match(/^(body|[a-z0-9]*#[^\s\[>,:]+)$/))return w.error("B.unmount","Target must be either 'body' or an id selector, but instead is "+e);var t="body"===e?document.body:document.getElementById(e.replace(/.*#/g,""));if(!w.prod&&!t)return w.error("B.unmount","Target not found:",e);o({selector:"*",from:t},function(e){e.id&&e.id.match(/^в[0-9a-f]+$/g)&&w.responders[e.id]&&w.forget(e.id)}),t.innerHTML=""},w.view=function(r,i){var o="array"!==l(r)?[[r]]:"array"!==l(r[0])?[r]:r;if(!w.prod&&s.stop("B.view",[v.stopNot(o,!1,function(e){return!!c.isPath(e)||w.error("B.view","Invalid path:",e,"Arguments",{path:e})}),function(){return["fun",i,"function"]}],function(e){w.error("B.view",e,{path:r})}))return!1;var a=w.B+w.internal.count++,u=function(){var e=w.internal.count,t=[],n=i.apply(null,v.go(o,w.get));if(!w.prod&&"Lith"!==w.validateLith(n))return w.error("B.view","View function must return a lith element but instead returned:",n,"Arguments:",{path:r});if(!w.prod&&"object"===l(n[1])&&n[1].id!==undefined)return w.error("B.view","View function must return a lith element without an id attribute but instead returned:",n,"Arguments:",{path:r});v.go(v.times(w.internal.count-e,e),function(e){e=w.responders[w.B+e];e.parent||(t.push(e.id),e.parent=a),e.priority=e.priority+w.responders[a].priority});e=v.obj("object"===l(n[1])?n[1]:{},{id:a,path:v.go(o,function(e){return e.join(":")||":"}).join(", ")},function(e,t){if(-1===["id","path"].indexOf(t.toLowerCase()))return[t,e]}),n=n.slice();return"object"!==l(n[1])?n.splice(1,0,e):n[1]=e,w.responders[a].elem=n,w.responders[a].children=t,n};return w.respond("change",[],{id:a,priority:-1,match:function(t){return v.stop(o,!0,function(e){return w.changeResponder(t,{verb:"change",path:e})})}},function(e){var t=w.responders[a].elem,n=w.responders[a].children,r=f();u()&&w.redraw(e,a,t,n,f()-r)}),u()},w.internal={count:1,timeout:200,queue:[],redrawing:!1},document.body.fireEvent&&!document.body.dispatchEvent&&(w.internal.oldIE=!0),!document.querySelectorAll&&w.internal.oldIE&&(w.internal.olderIE=!0),document.querySelectorAll||w.internal.oldIE||(w.internal.oldFF=!0),navigator.userAgent.match("Opera")&&(w.internal.oldOpera=!0),w.validateLith=function(e){var t=d.v(e,!0);if("Lith"!==t&&"Lithbag"!==t)return t;if("Lith"!==t)return v.stopNot(e,undefined,function(e){if("array"===l(e)){e=w.validateLith(e);return"Lith"!==e&&"Lithbag"!==e?e:void 0}})||"Lithbag";if("array"!==l(s.last(e)))return"Lith";e="style"===e[0]?w.validateLitc(s.last(e)):w.validateLith(s.last(e));return"Lith"===e||"Lithbag"===e||!0===e?"Lith":e},w.validateLitc=function(e){var t=d.css.v(e,!0);return!0!==t?t:"array"===l(e[0])?v.stopNot(e,!0,w.validateLitc):"array"!==l(s.last(e))||w.validateLitc(s.last(e))},document.body.contains||(document.body.contains=function(e){for(;e=e.parentNode;)if(e===document.body)return!0;return!1}),w.redraw=function(e,t,n,r,i,o){if(w.internal.redrawing&&!o)return w.internal.queue.push([e,t,n,r,i]);w.internal.redrawing=!0;var a=w.responders[t],u=document.getElementById(t),s=f();if(!(w.prod||u&&document.body.contains(u)))return w.error(e,"B.redraw","Attempt to redraw dangling element.",{responder:a});var c=[w.prediff(n),w.prediff(a.elem)],l=f(),o=w.diff(c[0],c[1]),n=f();if(v.go(r,function(e){w.forget(e)}),!1===o){c=(u=document.getElementById(t)).parentNode,r=u.nextSibling,t=d.g(a.elem,!0);c.removeChild(u),r?r.insertAdjacentHTML("beforeBegin",t):c.insertAdjacentHTML("beforeEnd",t)}else{u=w.applyDiff(u,o);if(!w.prod&&u!==undefined)return w.error(e,"B.redraw","Redraw error: DOM element missing.",{diffIndex:u,diffElement:o[u],diff:o,responder:a.id})}w.call(e,"redraw",e.path,{responder:a.id,ms:{create:i,prediff:l-s,diff:n-l,DOM:f()-n,total:f()-s+i},diff:!1!==o&&{length:o.length,edits:o.edits}});o=v.stopNot(w.internal.queue,undefined,function(){var e=w.internal.queue.shift();if(w.responders[e[1]])return e});o?w.redraw.apply(null,o.concat(!0)):w.internal.redrawing=!1},w.prediff=function(e,t){if("array"!==l(e)||"LITERAL"===e[0])return e===undefined||""===e?void 0:"L"!==t[t.length-1].substr(0,1)?t.push("L "+d.g(e,!0)):t[t.length-1]+=d.g(e,!0);if(t=t||[],-1===d.k.tags.indexOf(e[0]))return v.go(e,function(e){w.prediff(e,t)});e[1]&&e[1].id&&(e[1].id+"").match(/^в[0-9a-f]+$/g)&&t.length&&(e=w.responders[e[1].id].elem);var n,r,i="object"!==l(e[1])?undefined:v.obj(e[1],function(e,t){if(-1===["",null,!1,undefined].indexOf(e))return[t,e]}),o=e[i?2:1];if(t.push("O "+e[0]),i&&(t[t.length-1]+=" "+JSON.stringify(i)),i&&i.opaque){i=t[t.length-1].length;return t[t.length-1]="P "+i+t[t.length-1].slice(1)+" "+d.g(o,!0),t}return"style"===e[0]&&"array"===l(o)&&(o=d.css.g(o,!0)),"table"===e[0]&&(n=t.length),w.prediff(o,t),"table"===e[0]&&t[n]&&(t[n].match(/^O thead/)&&(r=0,v.stopNot(v.times(t.length-n,n),undefined,function(e){if("O"===t[e].substr(0,1)&&r++,"C"===t[e].substr(0,1)&&r--,0===r)return n=e+1})),t[n]&&!t[n].match(/^O tbody/)&&(t.splice(n,0,"O tbody"),t.push("C tbody")),w.internal.olderIE&&!t[n]&&t.splice(n,0,"O tbody","C tbody")),w.internal.olderIE&&"table"===e[0]&&!t[n]&&t.splice(n,0,"O tbody","C tbody"),t.push("C "+e[0]),t},w.applyDiff=function(r,a){var i,u=[],s=[],o={},c=r.parentNode,l=r.nextSibling,d=[r,null],f=[],e=v.stopNot(a,undefined,function(e,t){if("C"===e[1].substr(0,1))return"rem"!==e[0]&&(f.pop(),f[f.length-1]++),void("add"!==e[0]&&d.pop());if("rem"!==e[0]&&(s[t]=f.slice(),"O"===e[1].substr(0,1)?(o[s[t].join(",")]=t,f.push(0)):f[f.length-1]++),"add"!==e[0]){var n=0===t?r:d[d.length-1]?d[d.length-1].nextSibling:d[d.length-2].firstChild;if(!w.prod&&!n)return t;(u[t]=n)===document.activeElement&&(i=n),d[d.length-1]=n,"O"===e[1].substr(0,1)&&d.push(null)}});if(e!==undefined)return e;var p=function(e,t){return"tag"===t?e.match(/(O|P) [^\s]+/)[0].replace(/(O|P) /,""):e.match("{")?JSON.parse(e.replace(/[^{]+/,"")):{}},g=function(e,t){var n=0===e.length?c:u[o[e.slice(0,-1).join(",")]],r=n.children||n.childNodes;if(0===e.length){if(l&&l.previousSibling===t)return;if(!l&&r[r.length-1]===t)return}0<e.length&&r[e[e.length-1]]===t||(e=0===e.length?l:r[e[e.length-1]]||null,n.insertBefore(t,e))},h=function(e){var t=parseInt(e.match(/ \d+ /)[0].replace(/\s/g,""));return{element:(e=e.replace(t+" ","")).slice(0,t),contents:e.slice(t+1)}},m=function(e){if("L"===e.substr(0,1)){var t=document.createElement("div");return t.innerHTML=e.slice(2),t.firstChild}var n;"P"===e.substr(0,1)&&(e=(n=h(e)).element);var r=document.createElement(p(e,"tag"));return v.go(p(e,"attributes"),function(e,t){-1===["",null,!1].indexOf(e)&&r.setAttribute(w.internal.olderIE&&"class"===t?"className":t,e)}),"P"===e.substr(0,1)&&(r.innerHTML=n.contents),r},b={},y={};v.go(a,function(e,t){var n=e[1].substr(0,1);if("C"!==n){if("keep"===e[0]){if(w.internal.olderIE&&"O"===n&&p(e[1],"attributes").checked&&u[t].setAttribute("checked",!0),"P"!==n)return g(s[t],u[t]);u[t].parentNode.removeChild(u[t])}if("rem"===e[0])return"O"===n?(b[p(e[1],"tag")]=t,y[t]=!0):u[t].parentNode.removeChild(u[t]);if("L"===n)return g(s[t],m(e[1]));var r,i=p(e[1],"tag"),o=b[i];"P"!==n&&o!==undefined&&(r=function(n,e,t){var r=p(e,"attributes"),i=p(t,"attributes");if(!w.internal.oldIE||r.type===i.type)return v.go(i,function(e,t){e!==r[t]&&-1===["",null,!1].indexOf(e)&&(n.setAttribute(w.internal.olderIE&&"class"===t?"className":t,e),"value"===t&&(n.value=e),"checked"===t&&(n.checked=!0),w.internal.oldOpera&&"selected"===t&&(n.selected=e))}),v.go(r,function(e,t){e!==i[t]&&-1===["",null,!1].indexOf(e)&&-1!==["",null,!1,undefined].indexOf(i[t])&&(n.removeAttribute(w.internal.olderIE&&"class"===t?"className":t,e),"value"===t&&(n.value=""),"checked"===t&&(n.checked=!1))}),n}(u[o],a[o][1],e[1]))?b[i]=y[o]=undefined:r=m(e[1]),u[t]=r,g(s[t],r);e=w.internal.olderIE?p("O"===n?e[1]:h(e[1]).element,"attributes"):{};e.checked&&r.setAttribute("checked",!0),e["class"]&&(r.className=e["class"])}}),v.go(y,function(e,t){!0===e&&u[t].parentNode.removeChild(u[t])}),i&&document.body.contains(i)&&i!==document.activeElement&&(i.focus(),w.internal.oldIE&&i.focus())},w.diff=function(e,t){for(var n,r,i,o,a=[],u=[],s=0,c=f();s<=e.length+t.length;){if(w.internal.timeout&&f()-c>w.internal.timeout)return!1;for(i=-s,n=u[u.length-1]||{1:0},u.push(r={});i<=s;){for(o=i===-s||i!==s&&n[i+1]>n[i-1]?n[i+1]:n[i-1]+1;o<e.length&&o-i<t.length&&e[o]===t[o-i];)o++;if(!((r[i]=o)<e.length||o-i<t.length)){for(a.edits=s;0<o;){if(i===-s||i!==s&&u[s-1][i+1]>u[s-1][i-1]){for(i++;o>(0===s?0:u[s-1][i]);)a.unshift(["keep",e[o-1]]),o--;0<s&&a.unshift(["add",t[o-i]])}else{for(i--,o--;o>u[s-1][i];)a.unshift(["keep",e[o]]),o--;a.unshift(["rem",e[o]])}s--}return a}i+=2}s++}}}();